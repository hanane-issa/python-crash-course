
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>M8: Final Practice on a Heart Disease Dataset (with Solutions) &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Module-8/Module8_Solutions';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="M8: Final Practice on a Heart Disease Dataset" href="Module8_Questions.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Module8 - Practice Dataset</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Module8_Questions.html">Heart Disease Dataset - Questions</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Heart Disease Dataset - Solutions</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/hanane-issa/python-crash-course/melinda_module2foundations?urlpath=tree/Module-8/Module8_Solutions.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hanane-issa/python-crash-course" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hanane-issa/python-crash-course/issues/new?title=Issue%20on%20page%20%2FModule-8/Module8_Solutions.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Module-8/Module8_Solutions.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>M8: Final Practice on a Heart Disease Dataset (with Solutions)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-the-dataset">Loading the Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-understanding-the-dataset">Exercise 1: Understanding the Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#solution">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-import-the-dataset-using-the-uci-package">Exercise 2: Import the Dataset Using the UCI Package</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-explore-the-structure-of-the-dataset-object">Exercise 3: Explore the Structure of the Dataset Object</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-summarise-the-metadata">Exercise 4: Summarise the Metadata</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5-inspect-variable-details-and-metadata">Exercise 5: Inspect Variable Details and Metadata</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6-convert-data-to-dataframe-format-for-exploration">Exercise 6: Convert Data to DataFrame Format for Exploration</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Solution:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">Data Cleaning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7-investigating-missing-values-in-the-dataset">Exercise 7: Investigating Missing Values in the Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8-removing-rows-with-missing-values">Exercise 8: Removing Rows with Missing Values</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9-checking-for-duplicate-rows-and-columns">Exercise 9: Checking for Duplicate Rows and Columns</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-create-a-binary-target-variable">Exercise 10: Create a Binary Target Variable</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Solution:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11-classify-each-variable-by-type">Exercise 11: Classify Each Variable by Type</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-12-visualise-categorical-feature-distributions">Exercise 12: Visualise Categorical Feature Distributions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-13-visualising-numerical-features-distributions">Exercise 13: Visualising Numerical Features Distributions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-14-detecting-potential-outliers-with-boxplots">Exercise 14: Detecting Potential Outliers with Boxplots</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-15-compare-categorical-distributions-by-sex">Exercise 15: Compare Categorical Distributions by Sex</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-16-compare-numerical-features-by-sex">Exercise 16: Compare Numerical Features by Sex</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-17-boxplots-of-numerical-features-by-sex">Exercise 17: Boxplots of Numerical Features by Sex</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-18-exploring-relationships-between-numerical-features">Exercise 18: Exploring Relationships Between Numerical Features</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-19-spearman-correlation">Exercise 19: Spearman Correlation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-20-explore-numerical-feature-relationships-with-the-target-variable">Exercise 20: Explore Numerical Feature Relationships with the Target Variable</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-21-statistical-testing-of-numerical-feature-relationships-with-the-target-variable">Exercise 21: Statistical Testing of Numerical Feature Relationships with the Target Variable</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-21-exploring-categorical-feature-relationships-with-the-target-variable">Exercise 21: Exploring Categorical Feature Relationships with the Target Variable</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-22-statistical-testing-of-categorical-feature-relationships-with-the-target-variable">Exercise 22: Statistical Testing of Categorical Feature Relationships with the Target Variable</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Solution:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#congratulations-you-have-made-it-to-the-end-of-the-course">Congratulations, you have made it to the end of the course!</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="m8-final-practice-on-a-heart-disease-dataset-with-solutions">
<h1>M8: Final Practice on a Heart Disease Dataset (with Solutions)<a class="headerlink" href="#m8-final-practice-on-a-heart-disease-dataset-with-solutions" title="Link to this heading">#</a></h1>
<p>Congratulations, you have made it to the final module! Throughout the course, you have covered the fundamental knowledge and packages needed to apply Python in bioinformatics.</p>
<p>The aim of this module is to help you consolidate what you have learned. We will introduce a new dataset for you to analyse and explore. You’ll be given a series of exercises designed to be completed independently, with minimal external assistance.</p>
<p>If you find yourself stuck, make sure to give it a proper attempt on your own first. If that doesn’t resolve the issue, revisit earlier modules to refresh your memory. And if you’re still unsure, feel free to use Google. In fact, knowing how to look up code or functions to accomplish a task is an important skill in itself. As a last resort, you can consult the solution sheet.</p>
<hr class="docutils" />
<hr class="docutils" />
<section id="loading-the-dataset">
<h2>Loading the Dataset<a class="headerlink" href="#loading-the-dataset" title="Link to this heading">#</a></h2>
<p>The dataset that we will be using is the <em>Heart Disease Dataset</em> from the UC Irvine Machine Learning Repository: <a class="reference external" href="https://archive.ics.uci.edu/dataset/45/heart+disease">https://archive.ics.uci.edu/dataset/45/heart+disease</a></p>
<p>This dataset is intended for a machine learning task: given a set of patient features, the goal is to predict whether the patient has been diagnosed with heart disease (the target variable). While building such a model is beyond the scope of this course, you will conduct some initial exploratory analyses to become familiar with the dataset and its contents.</p>
<p>These exploratory analyses are often an essential first step, regardless of whether your aim is to develop a machine learning model or to pursue other kinds of investigation.</p>
<hr class="docutils" />
<section id="exercise-1-understanding-the-dataset">
<h3>Exercise 1: Understanding the Dataset<a class="headerlink" href="#exercise-1-understanding-the-dataset" title="Link to this heading">#</a></h3>
<p><em>Take a few minutes to read through the dataset description on the website to familiarise yourself with its structure and the variables it contains.</em></p>
<section id="solution">
<h4>Solution:<a class="headerlink" href="#solution" title="Link to this heading">#</a></h4>
<p><em>The website states that 14 out of 75 patient attributes are used for the classification task (determining whether a patient has heart disease). Of these, 13 are features, and the 14th is the target variable. A description of each variable can be found in the variables table.</em></p>
<hr class="docutils" />
<p>Great! Now that you’ve had a look at the dataset description, let’s dive into the data itself.</p>
<p>Don’t worry if you didn’t understand everything — things should become clearer as you familiarise yourself with the dataset through practice.</p>
<p>At the top right-hand side of the dataset’s website, you’ll find a button labelled <code class="docutils literal notranslate"><span class="pre">IMPORT</span> <span class="pre">IN</span> <span class="pre">PYTHON</span></code>. Clicking on it will show you which package to install and how to load the dataset.</p>
<p><img alt="Overview of the website" src="../_images/websitescreenshot_overview.png" /></p>
<p><img alt="Import overview" src="../_images/websitescreenshot_import.png" /></p>
<div class="tip admonition">
<p class="admonition-title">Tip</p>
<p>For the first part of the exercises, you mainly just need to follow the example code from the website.</p>
<p>Take your time going through the initial code, it will help you start exploring the dataset and understanding what is being provided and how to work with it.</p>
</div>
</section>
</section>
<hr class="docutils" />
<section id="exercise-2-import-the-dataset-using-the-uci-package">
<h3>Exercise 2: Import the Dataset Using the UCI Package<a class="headerlink" href="#exercise-2-import-the-dataset-using-the-uci-package" title="Link to this heading">#</a></h3>
<p><em>Install the required package (using any of the methods you’ve learned) and import it into your code.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h4>Solution:<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Try to import the library. If it&#39;s not installed, install it using pip.</span>
<span class="c1"># (This works in a Jupyter notebook; if you&#39;re using a terminal instead, run: pip install ucimlrepo)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">ucimlrepo</span><span class="w"> </span><span class="kn">import</span> <span class="n">fetch_ucirepo</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>ucimlrepo
    <span class="kn">from</span><span class="w"> </span><span class="nn">ucimlrepo</span><span class="w"> </span><span class="kn">import</span> <span class="n">fetch_ucirepo</span>

<span class="c1"># If you&#39;re using a Conda environment, you could also install it via the terminal with:</span>
<span class="c1"># conda install -c conda-forge ucimlrepo</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="exercise-3-explore-the-structure-of-the-dataset-object">
<h3>Exercise 3: Explore the Structure of the Dataset Object<a class="headerlink" href="#exercise-3-explore-the-structure-of-the-dataset-object" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>Create a Heart Disease dataset object using <code class="docutils literal notranslate"><span class="pre">fetch_ucirepo(id=45)</span></code>.</em></p></li>
<li><p><em>Check the <strong>type</strong> of the dataset object you’ve created.</em></p></li>
<li><p><em>Use <code class="docutils literal notranslate"><span class="pre">dir()</span></code> on the object to list its attributes.</em></p></li>
<li><p><em>Try accessing <code class="docutils literal notranslate"><span class="pre">.metadata</span></code>, <code class="docutils literal notranslate"><span class="pre">.variables</span></code>, and <code class="docutils literal notranslate"><span class="pre">.data</span></code>. What kind of information do they contain? What type are they?</em></p></li>
</ol>
<p><em>This will help you understand how the dataset is structured and how to navigate it.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h4>Solution:<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Fetch the dataset</span>
<span class="n">heart_disease</span> <span class="o">=</span> <span class="n">fetch_ucirepo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

<span class="c1"># 2. Print the type of the dataset object</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Type of heart_disease object:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">heart_disease</span><span class="p">))</span>

<span class="c1"># 3. List available attributes and methods</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Attributes and methods of heart_disease:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">heart_disease</span><span class="p">))</span>

<span class="c1"># 4.1 Access and check the type of metadata</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Type of heart_disease.metadata:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">heart_disease</span><span class="o">.</span><span class="n">metadata</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample metadata keys:&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">heart_disease</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">5</span><span class="p">])</span>

<span class="c1"># 4.2 Access and check the type of variables</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Type of heart_disease.variables:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">heart_disease</span><span class="o">.</span><span class="n">variables</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">heart_disease</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># 4.3 Access and check the type of data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Type of heart_disease.data:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">heart_disease</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Keys in heart_disease.data:&quot;</span><span class="p">,</span> <span class="n">heart_disease</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type of heart_disease object: &lt;class &#39;ucimlrepo.dotdict.dotdict&#39;&gt;

Attributes and methods of heart_disease:
[&#39;__class__&#39;, &#39;__class_getitem__&#39;, &#39;__contains__&#39;, &#39;__delattr__&#39;, &#39;__delitem__&#39;, &#39;__dict__&#39;, &#39;__dir__&#39;, &#39;__doc__&#39;, &#39;__eq__&#39;, &#39;__format__&#39;, &#39;__ge__&#39;, &#39;__getattr__&#39;, &#39;__getattribute__&#39;, &#39;__getitem__&#39;, &#39;__gt__&#39;, &#39;__hash__&#39;, &#39;__init__&#39;, &#39;__init_subclass__&#39;, &#39;__ior__&#39;, &#39;__iter__&#39;, &#39;__le__&#39;, &#39;__len__&#39;, &#39;__lt__&#39;, &#39;__module__&#39;, &#39;__ne__&#39;, &#39;__new__&#39;, &#39;__or__&#39;, &#39;__reduce__&#39;, &#39;__reduce_ex__&#39;, &#39;__repr__&#39;, &#39;__reversed__&#39;, &#39;__ror__&#39;, &#39;__setattr__&#39;, &#39;__setitem__&#39;, &#39;__sizeof__&#39;, &#39;__str__&#39;, &#39;__subclasshook__&#39;, &#39;__weakref__&#39;, &#39;clear&#39;, &#39;copy&#39;, &#39;fromkeys&#39;, &#39;get&#39;, &#39;items&#39;, &#39;keys&#39;, &#39;pop&#39;, &#39;popitem&#39;, &#39;setdefault&#39;, &#39;update&#39;, &#39;values&#39;]

Type of heart_disease.metadata: &lt;class &#39;ucimlrepo.dotdict.dotdict&#39;&gt;
Sample metadata keys: [&#39;uci_id&#39;, &#39;name&#39;, &#39;repository_url&#39;, &#39;data_url&#39;, &#39;abstract&#39;]

Type of heart_disease.variables: &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
       name     role         type demographic  \
0       age  Feature      Integer         Age   
1       sex  Feature  Categorical         Sex   
2        cp  Feature  Categorical        None   
3  trestbps  Feature      Integer        None   
4      chol  Feature      Integer        None   

                                         description  units missing_values  
0                                               None  years             no  
1                                               None   None             no  
2                                               None   None             no  
3  resting blood pressure (on admission to the ho...  mm Hg             no  
4                                  serum cholestoral  mg/dl             no  

Type of heart_disease.data: &lt;class &#39;ucimlrepo.dotdict.dotdict&#39;&gt;
Keys in heart_disease.data: dict_keys([&#39;ids&#39;, &#39;features&#39;, &#39;targets&#39;, &#39;original&#39;, &#39;headers&#39;])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="exercise-4-summarise-the-metadata">
<h3>Exercise 4: Summarise the Metadata<a class="headerlink" href="#exercise-4-summarise-the-metadata" title="Link to this heading">#</a></h3>
<p><em>Print the metadata information about the dataset. Try to answer the following questions based on what you find:</em></p>
<ol class="arabic simple">
<li><p><em>How many data points (patients) and how many features are there?</em></p></li>
<li><p><em>What are the names of the demographic features?</em></p></li>
<li><p><em>What is the name of the target variable?</em></p></li>
<li><p><em>Are there any missing values in the dataset? How can you identify them?</em></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id3">
<h4>Solution:<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access the metadata</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="n">heart_disease</span><span class="o">.</span><span class="n">metadata</span>

<span class="c1"># Print metadata to visually inspect</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Metadata:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>

<span class="c1"># 1. How many data points (patients) and how many features are there?</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Number of data points (patients):&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;num_instances&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of features used:&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;num_features&#39;</span><span class="p">])</span>

<span class="c1"># 2. What are the names of the demographic features?</span>
<span class="c1"># These are provided directly in the &#39;demographics&#39; field</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Demographic features:&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;demographics&#39;</span><span class="p">])</span>

<span class="c1"># 3. What is the name of the target variable?</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Target variable name:&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;target_col&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># 4. Are there any missing values in the dataset? If so, how can they be identified?</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Does the dataset contain missing values?:&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;has_missing_values&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Symbol used for missing values:&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;missing_values_symbol&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Metadata:
 {&#39;uci_id&#39;: 45, &#39;name&#39;: &#39;Heart Disease&#39;, &#39;repository_url&#39;: &#39;https://archive.ics.uci.edu/dataset/45/heart+disease&#39;, &#39;data_url&#39;: &#39;https://archive.ics.uci.edu/static/public/45/data.csv&#39;, &#39;abstract&#39;: &#39;4 databases: Cleveland, Hungary, Switzerland, and the VA Long Beach&#39;, &#39;area&#39;: &#39;Health and Medicine&#39;, &#39;tasks&#39;: [&#39;Classification&#39;], &#39;characteristics&#39;: [&#39;Multivariate&#39;], &#39;num_instances&#39;: 303, &#39;num_features&#39;: 13, &#39;feature_types&#39;: [&#39;Categorical&#39;, &#39;Integer&#39;, &#39;Real&#39;], &#39;demographics&#39;: [&#39;Age&#39;, &#39;Sex&#39;], &#39;target_col&#39;: [&#39;num&#39;], &#39;index_col&#39;: None, &#39;has_missing_values&#39;: &#39;yes&#39;, &#39;missing_values_symbol&#39;: &#39;NaN&#39;, &#39;year_of_dataset_creation&#39;: 1989, &#39;last_updated&#39;: &#39;Fri Nov 03 2023&#39;, &#39;dataset_doi&#39;: &#39;10.24432/C52P4X&#39;, &#39;creators&#39;: [&#39;Andras Janosi&#39;, &#39;William Steinbrunn&#39;, &#39;Matthias Pfisterer&#39;, &#39;Robert Detrano&#39;], &#39;intro_paper&#39;: {&#39;ID&#39;: 231, &#39;type&#39;: &#39;NATIVE&#39;, &#39;title&#39;: &#39;International application of a new probability algorithm for the diagnosis of coronary artery disease.&#39;, &#39;authors&#39;: &#39;R. Detrano, A. Jánosi, W. Steinbrunn, M. Pfisterer, J. Schmid, S. Sandhu, K. Guppy, S. Lee, V. Froelicher&#39;, &#39;venue&#39;: &#39;American Journal of Cardiology&#39;, &#39;year&#39;: 1989, &#39;journal&#39;: None, &#39;DOI&#39;: None, &#39;URL&#39;: &#39;https://www.semanticscholar.org/paper/a7d714f8f87bfc41351eb5ae1e5472f0ebbe0574&#39;, &#39;sha&#39;: None, &#39;corpus&#39;: None, &#39;arxiv&#39;: None, &#39;mag&#39;: None, &#39;acl&#39;: None, &#39;pmid&#39;: &#39;2756873&#39;, &#39;pmcid&#39;: None}, &#39;additional_info&#39;: {&#39;summary&#39;: &#39;This database contains 76 attributes, but all published experiments refer to using a subset of 14 of them.  In particular, the Cleveland database is the only one that has been used by ML researchers to date.  The &quot;goal&quot; field refers to the presence of heart disease in the patient.  It is integer valued from 0 (no presence) to 4. Experiments with the Cleveland database have concentrated on simply attempting to distinguish presence (values 1,2,3,4) from absence (value 0).  \n   \nThe names and social security numbers of the patients were recently removed from the database, replaced with dummy values.\n\nOne file has been &quot;processed&quot;, that one containing the Cleveland database.  All four unprocessed files also exist in this directory.\n\nTo see Test Costs (donated by Peter Turney), please see the folder &quot;Costs&quot; &#39;, &#39;purpose&#39;: None, &#39;funded_by&#39;: None, &#39;instances_represent&#39;: None, &#39;recommended_data_splits&#39;: None, &#39;sensitive_data&#39;: None, &#39;preprocessing_description&#39;: None, &#39;variable_info&#39;: &#39;Only 14 attributes used:\r\n      1. #3  (age)       \r\n      2. #4  (sex)       \r\n      3. #9  (cp)        \r\n      4. #10 (trestbps)  \r\n      5. #12 (chol)      \r\n      6. #16 (fbs)       \r\n      7. #19 (restecg)   \r\n      8. #32 (thalach)   \r\n      9. #38 (exang)     \r\n      10. #40 (oldpeak)   \r\n      11. #41 (slope)     \r\n      12. #44 (ca)        \r\n      13. #51 (thal)      \r\n      14. #58 (num)       (the predicted attribute)\r\n\r\nComplete attribute documentation:\r\n      1 id: patient identification number\r\n      2 ccf: social security number (I replaced this with a dummy value of 0)\r\n      3 age: age in years\r\n      4 sex: sex (1 = male; 0 = female)\r\n      5 painloc: chest pain location (1 = substernal; 0 = otherwise)\r\n      6 painexer (1 = provoked by exertion; 0 = otherwise)\r\n      7 relrest (1 = relieved after rest; 0 = otherwise)\r\n      8 pncaden (sum of 5, 6, and 7)\r\n      9 cp: chest pain type\r\n        -- Value 1: typical angina\r\n        -- Value 2: atypical angina\r\n        -- Value 3: non-anginal pain\r\n        -- Value 4: asymptomatic\r\n     10 trestbps: resting blood pressure (in mm Hg on admission to the hospital)\r\n     11 htn\r\n     12 chol: serum cholestoral in mg/dl\r\n     13 smoke: I believe this is 1 = yes; 0 = no (is or is not a smoker)\r\n     14 cigs (cigarettes per day)\r\n     15 years (number of years as a smoker)\r\n     16 fbs: (fasting blood sugar &gt; 120 mg/dl)  (1 = true; 0 = false)\r\n     17 dm (1 = history of diabetes; 0 = no such history)\r\n     18 famhist: family history of coronary artery disease (1 = yes; 0 = no)\r\n     19 restecg: resting electrocardiographic results\r\n        -- Value 0: normal\r\n        -- Value 1: having ST-T wave abnormality (T wave inversions and/or ST elevation or depression of &gt; 0.05 mV)\r\n        -- Value 2: showing probable or definite left ventricular hypertrophy by Estes\&#39; criteria\r\n     20 ekgmo (month of exercise ECG reading)\r\n     21 ekgday(day of exercise ECG reading)\r\n     22 ekgyr (year of exercise ECG reading)\r\n     23 dig (digitalis used furing exercise ECG: 1 = yes; 0 = no)\r\n     24 prop (Beta blocker used during exercise ECG: 1 = yes; 0 = no)\r\n     25 nitr (nitrates used during exercise ECG: 1 = yes; 0 = no)\r\n     26 pro (calcium channel blocker used during exercise ECG: 1 = yes; 0 = no)\r\n     27 diuretic (diuretic used used during exercise ECG: 1 = yes; 0 = no)\r\n     28 proto: exercise protocol\r\n          1 = Bruce     \r\n          2 = Kottus\r\n          3 = McHenry\r\n          4 = fast Balke\r\n          5 = Balke\r\n          6 = Noughton \r\n          7 = bike 150 kpa min/min  (Not sure if &quot;kpa min/min&quot; is what was written!)\r\n          8 = bike 125 kpa min/min  \r\n          9 = bike 100 kpa min/min\r\n         10 = bike 75 kpa min/min\r\n         11 = bike 50 kpa min/min\r\n         12 = arm ergometer\r\n     29 thaldur: duration of exercise test in minutes\r\n     30 thaltime: time when ST measure depression was noted\r\n     31 met: mets achieved\r\n     32 thalach: maximum heart rate achieved\r\n     33 thalrest: resting heart rate\r\n     34 tpeakbps: peak exercise blood pressure (first of 2 parts)\r\n     35 tpeakbpd: peak exercise blood pressure (second of 2 parts)\r\n     36 dummy\r\n     37 trestbpd: resting blood pressure\r\n     38 exang: exercise induced angina (1 = yes; 0 = no)\r\n     39 xhypo: (1 = yes; 0 = no)\r\n     40 oldpeak = ST depression induced by exercise relative to rest\r\n     41 slope: the slope of the peak exercise ST segment\r\n        -- Value 1: upsloping\r\n        -- Value 2: flat\r\n        -- Value 3: downsloping\r\n     42 rldv5: height at rest\r\n     43 rldv5e: height at peak exercise\r\n     44 ca: number of major vessels (0-3) colored by flourosopy\r\n     45 restckm: irrelevant\r\n     46 exerckm: irrelevant\r\n     47 restef: rest raidonuclid (sp?) ejection fraction\r\n     48 restwm: rest wall (sp?) motion abnormality\r\n        0 = none\r\n        1 = mild or moderate\r\n        2 = moderate or severe\r\n        3 = akinesis or dyskmem (sp?)\r\n     49 exeref: exercise radinalid (sp?) ejection fraction\r\n     50 exerwm: exercise wall (sp?) motion \r\n     51 thal: 3 = normal; 6 = fixed defect; 7 = reversable defect\r\n     52 thalsev: not used\r\n     53 thalpul: not used\r\n     54 earlobe: not used\r\n     55 cmo: month of cardiac cath (sp?)  (perhaps &quot;call&quot;)\r\n     56 cday: day of cardiac cath (sp?)\r\n     57 cyr: year of cardiac cath (sp?)\r\n     58 num: diagnosis of heart disease (angiographic disease status)\r\n        -- Value 0: &lt; 50% diameter narrowing\r\n        -- Value 1: &gt; 50% diameter narrowing\r\n        (in any major vessel: attributes 59 through 68 are vessels)\r\n     59 lmt\r\n     60 ladprox\r\n     61 laddist\r\n     62 diag\r\n     63 cxmain\r\n     64 ramus\r\n     65 om1\r\n     66 om2\r\n     67 rcaprox\r\n     68 rcadist\r\n     69 lvx1: not used\r\n     70 lvx2: not used\r\n     71 lvx3: not used\r\n     72 lvx4: not used\r\n     73 lvf: not used\r\n     74 cathef: not used\r\n     75 junk: not used\r\n     76 name: last name of patient  (I replaced this with the dummy string &quot;name&quot;)&#39;, &#39;citation&#39;: None}}

Number of data points (patients): 303
Number of features used: 13
Demographic features: [&#39;Age&#39;, &#39;Sex&#39;]
Target variable name: num
Does the dataset contain missing values?: yes
Symbol used for missing values: NaN
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="exercise-5-inspect-variable-details-and-metadata">
<h3>Exercise 5: Inspect Variable Details and Metadata<a class="headerlink" href="#exercise-5-inspect-variable-details-and-metadata" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>Save the feature information from <code class="docutils literal notranslate"><span class="pre">dataset.variables</span></code> in a new variable</em></p></li>
<li><p><em>Print the variable information and its type.</em></p></li>
<li><p><em>Which variables have missing values?</em></p></li>
<li><p><em>What is the unit of <strong>resting blood pressure</strong>?</em></p></li>
<li><p><em>How many categorical variables are there?</em></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id4">
<h4>Solution:<a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Get the variables table</span>
<span class="n">variables</span> <span class="o">=</span> <span class="n">heart_disease</span><span class="o">.</span><span class="n">variables</span>

<span class="c1"># 2. Print the variables table to visually inspect it</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables table:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Type of the table:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">variables</span><span class="p">))</span>

<span class="c1"># 3. Which variables have missing values?</span>
<span class="n">variables_with_missing_values</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;missing_values&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variables with missing values:&quot;</span><span class="p">,</span> <span class="n">variables_with_missing_values</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

<span class="c1"># 4. What is the unit of &#39;resting blood pressure&#39;?</span>
<span class="n">resting_bp_info</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;trestbps&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Unit of &#39;resting blood pressure&#39;:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resting_bp_info</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">]])</span>

<span class="c1"># 5. How many categorical variables are there?</span>
<span class="c1"># Count the number of variables where &#39;type&#39; is &#39;Categorical&#39;</span>
<span class="n">categorical_count</span> <span class="o">=</span> <span class="p">(</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Categorical&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Number of categorical variables:&quot;</span><span class="p">,</span> <span class="n">categorical_count</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables table:

        name     role         type demographic  \
0        age  Feature      Integer         Age   
1        sex  Feature  Categorical         Sex   
2         cp  Feature  Categorical        None   
3   trestbps  Feature      Integer        None   
4       chol  Feature      Integer        None   
5        fbs  Feature  Categorical        None   
6    restecg  Feature  Categorical        None   
7    thalach  Feature      Integer        None   
8      exang  Feature  Categorical        None   
9    oldpeak  Feature      Integer        None   
10     slope  Feature  Categorical        None   
11        ca  Feature      Integer        None   
12      thal  Feature  Categorical        None   
13       num   Target      Integer        None   

                                          description  units missing_values  
0                                                None  years             no  
1                                                None   None             no  
2                                                None   None             no  
3   resting blood pressure (on admission to the ho...  mm Hg             no  
4                                   serum cholestoral  mg/dl             no  
5                     fasting blood sugar &gt; 120 mg/dl   None             no  
6                                                None   None             no  
7                         maximum heart rate achieved   None             no  
8                             exercise induced angina   None             no  
9   ST depression induced by exercise relative to ...   None             no  
10                                               None   None             no  
11  number of major vessels (0-3) colored by flour...   None            yes  
12                                               None   None            yes  
13                         diagnosis of heart disease   None             no  
Type of the table: &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;

Variables with missing values: 11      ca
12    thal
Name: name, dtype: object

Unit of &#39;resting blood pressure&#39;:
       name  units
3  trestbps  mm Hg

Number of categorical variables: 7
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="exercise-6-convert-data-to-dataframe-format-for-exploration">
<h3>Exercise 6: Convert Data to DataFrame Format for Exploration<a class="headerlink" href="#exercise-6-convert-data-to-dataframe-format-for-exploration" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>Extract the feature values and the target values from the dataset into two separate variables. Print each of them.</em></p></li>
<li><p><em>Do the number of rows and columns make sense?</em></p></li>
<li><p><em>Are you able to understand what information they contain based on the metadata exploration? If not, revisit the website, metadata, and variable information to clarify.</em></p></li>
<li><p><em>Import the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library.</em></p></li>
<li><p><em>Combine the feature and target values into a single pandas DataFrame, where each row represents a patient and each column represents a feature, with the final column being the target variable.</em></p></li>
<li><p><em>Display the first five rows of the resulting DataFrame.</em></p></li>
</ol>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Tip</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">If you’re unsure how best to combine the features and target, start by checking their types. You’ll see that both are already in the pandas framework, so you’ll need to use a pandas command to combine them into the required layout — this should only take one line of code.</p>
<p class="sd-card-text">Whenever you’re unsure how to manipulate the data, your first step should always be to check its type. This will help you better understand what operations are available.</p>
</div>
</details><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id5">
<h4>Solution:<a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1.1 Extract the feature values and target values</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">heart_disease</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">features</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">heart_disease</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">targets</span>

<span class="c1"># 1.2 Print the feature values and target values</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feature values (X):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Target values (y):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># 2. Print the shapes of both to check dimensions</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of rows in X:&quot;</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;and in y:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;. Which is the same as number of patients.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of columns in X:&quot;</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;and in y:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;. Which is the same as number of features and target values respectively.&quot;</span><span class="p">)</span>

<span class="c1"># 3. Each column in X corresponds to a feature, and the column in y corresponds to the target variable.</span>
<span class="c1"># Each row represents a patient, so each entry is the value of a feature (or target) for a given patient.</span>

<span class="c1"># 4. Import the pandas library</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># 5. Concatenate the features and target side by side</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 6. Display the first five rows of the resulting DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Combined DataFrame (first 5 rows):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Feature values (X):
      age  sex  cp  trestbps  chol  fbs  restecg  thalach  exang  oldpeak  \
0     63    1   1       145   233    1        2      150      0      2.3   
1     67    1   4       160   286    0        2      108      1      1.5   
2     67    1   4       120   229    0        2      129      1      2.6   
3     37    1   3       130   250    0        0      187      0      3.5   
4     41    0   2       130   204    0        2      172      0      1.4   
..   ...  ...  ..       ...   ...  ...      ...      ...    ...      ...   
298   45    1   1       110   264    0        0      132      0      1.2   
299   68    1   4       144   193    1        0      141      0      3.4   
300   57    1   4       130   131    0        0      115      1      1.2   
301   57    0   2       130   236    0        2      174      0      0.0   
302   38    1   3       138   175    0        0      173      0      0.0   

     slope   ca  thal  
0        3  0.0   6.0  
1        2  3.0   3.0  
2        2  2.0   7.0  
3        3  0.0   3.0  
4        1  0.0   3.0  
..     ...  ...   ...  
298      2  0.0   7.0  
299      2  2.0   7.0  
300      2  1.0   7.0  
301      2  1.0   3.0  
302      1  NaN   3.0  

[303 rows x 13 columns]

Target values (y):
      num
0      0
1      2
2      1
3      0
4      0
..   ...
298    1
299    2
300    3
301    1
302    0

[303 rows x 1 columns]
Number of rows in X: 303 and in y: 303 . Which is the same as number of patients.
Number of columns in X: 13 and in y: 1 . Which is the same as number of features and target values respectively.

Combined DataFrame (first 5 rows):
   age  sex  cp  trestbps  chol  fbs  restecg  thalach  exang  oldpeak  slope  \
0   63    1   1       145   233    1        2      150      0      2.3      3   
1   67    1   4       160   286    0        2      108      1      1.5      2   
2   67    1   4       120   229    0        2      129      1      2.6      2   
3   37    1   3       130   250    0        0      187      0      3.5      3   
4   41    0   2       130   204    0        2      172      0      1.4      1   

    ca  thal  num  
0  0.0   6.0    0  
1  3.0   3.0    2  
2  2.0   7.0    1  
3  0.0   3.0    0  
4  0.0   3.0    0  
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
</section>
<hr class="docutils" />
<section id="data-cleaning">
<h2>Data Cleaning<a class="headerlink" href="#data-cleaning" title="Link to this heading">#</a></h2>
<p>Now that we have everything in a single, tidy DataFrame, we need to make sure the data is properly cleaned before we begin analysing it.</p>
<p>Let’s start with missing values. From the metadata, we already know that the features <code class="docutils literal notranslate"><span class="pre">ca</span></code> and <code class="docutils literal notranslate"><span class="pre">thal</span></code> contain missing values.</p>
<hr class="docutils" />
<section id="exercise-7-investigating-missing-values-in-the-dataset">
<h3>Exercise 7: Investigating Missing Values in the Dataset<a class="headerlink" href="#exercise-7-investigating-missing-values-in-the-dataset" title="Link to this heading">#</a></h3>
<p><em>To decide how to handle these missing values, we first need a more detailed understanding. For both <code class="docutils literal notranslate"><span class="pre">ca</span></code> and <code class="docutils literal notranslate"><span class="pre">thal</span></code>, print the following information:</em></p>
<ol class="arabic simple">
<li><p><em>The full column of values.</em></p></li>
<li><p><em>How many times each contains a <code class="docutils literal notranslate"><span class="pre">NaN</span></code> value.</em></p></li>
<li><p><em>The number of unique values in the column, and what those values are.</em></p></li>
<li><p><em>The type of each feature (use the variable information DataFrame to check this).</em></p></li>
<li><p><em>Based on these results, think about what the best way to handle the missing data is.</em></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id6">
<h4>Solution:<a class="headerlink" href="#id6" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Inspect the &#39;ca&#39; column</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--- &quot;ca&quot; column ---&#39;</span><span class="p">)</span>

<span class="c1"># 1. Print the full column of values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">])</span>

<span class="c1"># 2. Count the number of NaN values in &#39;ca&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of NaN values in &quot;ca&quot;: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ca&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># 3. Count and print the unique values in &#39;ca&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of unique values in &quot;ca&quot;: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ca&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unique values in &quot;ca&quot;: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ca&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># 4. Print the feature type from the variable information</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Data type of &quot;ca&quot;: </span><span class="si">{</span><span class="n">variables</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;ca&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>


<span class="c1"># Inspect the &#39;thal&#39; column</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--- &quot;thal&quot; column ---&#39;</span><span class="p">)</span>

<span class="c1"># 1. Print the full column of values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;thal&#39;</span><span class="p">])</span>

<span class="c1"># 2. Count the number of NaN values in &#39;thal&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of NaN values in &quot;thal&quot;: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;thal&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># 3. Count and print the unique values in &#39;thal&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of unique values in &quot;thal&quot;: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;thal&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unique values in &quot;thal&quot;: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;thal&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># 4. Print the feature type from the variable information</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Data type of &quot;thal&quot;: </span><span class="si">{</span><span class="n">variables</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;thal&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- &quot;ca&quot; column ---
0      0.0
1      3.0
2      2.0
3      0.0
4      0.0
      ... 
298    0.0
299    2.0
300    1.0
301    1.0
302    NaN
Name: ca, Length: 303, dtype: float64
Number of NaN values in &quot;ca&quot;: 4
Number of unique values in &quot;ca&quot;: 4
Unique values in &quot;ca&quot;: [ 0.  3.  2.  1. nan]
Data type of &quot;ca&quot;: Integer


--- &quot;thal&quot; column ---
0      6.0
1      3.0
2      7.0
3      3.0
4      3.0
      ... 
298    7.0
299    7.0
300    7.0
301    3.0
302    3.0
Name: thal, Length: 303, dtype: float64
Number of NaN values in &quot;thal&quot;: 2
Number of unique values in &quot;thal&quot;: 3
Unique values in &quot;thal&quot;: [ 6.  3.  7. nan]
Data type of &quot;thal&quot;: Categorical
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>You should notice that <code class="docutils literal notranslate"><span class="pre">ca</span></code> contains integer values, while <code class="docutils literal notranslate"><span class="pre">thal</span></code> is categorical, with each having four or three unique values respectively (excluding <code class="docutils literal notranslate"><span class="pre">NaN</span></code>). For this reason, it wouldn’t make sense to replace the missing values with the mean. Instead, we could replace them with the mode (the category or integer that is most common for that feature). However, since only a maximum of six patients out of the 303 have missing values (four for <code class="docutils literal notranslate"><span class="pre">ca</span></code> and two for <code class="docutils literal notranslate"><span class="pre">thal</span></code>), we can instead simply remove patients (rows) with any missing (<code class="docutils literal notranslate"><span class="pre">NaN</span></code>) values without losing too much data.</p>
</section>
</section>
<hr class="docutils" />
<section id="exercise-8-removing-rows-with-missing-values">
<h3>Exercise 8: Removing Rows with Missing Values<a class="headerlink" href="#exercise-8-removing-rows-with-missing-values" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>Remove all rows (patients) that contain any <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values.</em></p></li>
<li><p><em>Reset the row index after dropping the rows with missing data.</em></p></li>
<li><p><em>Print the number of NaN values in each column to confirm that none remain.</em></p></li>
<li><p><em>Print the shape of the DataFrame and check whether the number of rows makes sense.</em></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id7">
<h4>Solution:<a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Removing rows with NaN values in the &quot;ca&quot; and &quot;thal&quot; columns...&#39;</span><span class="p">)</span>

<span class="c1"># 1. Remove rows with NaN in &#39;ca&#39; or &#39;thal&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">,</span> <span class="s1">&#39;thal&#39;</span><span class="p">])</span>

<span class="c1"># 2. Reset the row index</span>
<span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 3. Confirm removal by printing the number of NaN values per column</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Number of NaN values per column (after removal):&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># 4. Print the final shape of the cleaned DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Shape of the cleaned DataFrame:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Removing rows with NaN values in the &quot;ca&quot; and &quot;thal&quot; columns...

Number of NaN values per column (after removal):
age         0
sex         0
cp          0
trestbps    0
chol        0
fbs         0
restecg     0
thalach     0
exang       0
oldpeak     0
slope       0
ca          0
thal        0
num         0
dtype: int64

Shape of the cleaned DataFrame:
(297, 14)
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>Great! Now you should have no missing values in your dataset.A different issue that can sometimes occur is data being entered incorrectly, resulting in duplicate patients or duplicate features (i.e. rows or columns with exactly the same values). We need to check that this isn’t the case in our dataset.</p>
</section>
</section>
<hr class="docutils" />
<section id="exercise-9-checking-for-duplicate-rows-and-columns">
<h3>Exercise 9: Checking for Duplicate Rows and Columns<a class="headerlink" href="#exercise-9-checking-for-duplicate-rows-and-columns" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>Identify any duplicate rows.</em></p></li>
<li><p><em>Print the number of duplicate rows.</em></p></li>
<li><p><em>Write an <code class="docutils literal notranslate"><span class="pre">if</span></code> statement that prints and removes the duplicate rows, if any are found.</em></p></li>
<li><p><em>Repeat the same process for duplicate columns.</em></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id8">
<h4>Solution:<a class="headerlink" href="#id8" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Check for duplicate rows</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Checking for duplicate rows:&quot;</span><span class="p">)</span>
<span class="n">duplicate_rows</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>

<span class="c1"># 2. Print the number of duplicate rows</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of duplicate rows: </span><span class="si">{</span><span class="n">duplicate_rows</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 3. Show the actual duplicate rows and remove them (if any)</span>
<span class="k">if</span> <span class="n">duplicate_rows</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Duplicate rows:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">duplicate_rows</span><span class="p">])</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">duplicate_rows</span><span class="p">]</span>  <span class="c1"># Remove duplicate rows</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Duplicate rows have been removed.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated DataFrame shape:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No duplicate rows found.&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-----------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 4. Check for duplicate columns</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Checking for duplicate columns:&quot;</span><span class="p">)</span>
<span class="c1"># Transpose the DataFrame to treat columns as rows for duplicate detection</span>
<span class="n">duplicate_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of duplicate columns: </span><span class="si">{</span><span class="n">duplicate_columns</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Show the names of duplicate columns and remove them (if any)</span>
<span class="k">if</span> <span class="n">duplicate_columns</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Duplicate column names:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">duplicate_columns</span><span class="p">])</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="o">~</span><span class="n">duplicate_columns</span><span class="p">]</span>  <span class="c1"># Remove duplicate columns</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Duplicate columns have been removed.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated DataFrame shape:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No duplicate columns found.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Checking for duplicate rows:
Number of duplicate rows: 0
No duplicate rows found.

-----------------------------

Checking for duplicate columns:
Number of duplicate columns: 0
No duplicate columns found.
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>As a final step, we want to ensure that the target variable (<code class="docutils literal notranslate"><span class="pre">num</span></code>) is in the correct format.</p>
<p>According to the website, it should take five possible values: 0, 1, 2, 3, and 4.
A value of 0 indicates no heart disease, while values 1–4 represent different categories of heart disease.</p>
<p>For your analyses, you may only be interested in whether the patient has the disease or not, but not which type. This is often the case in binary classification tasks, or simply to make the analysis more straightforward.  In such cases, the target values need to be converted into binary:</p>
<ul class="simple">
<li><p>0 → no heart disease  (False / 0)</p></li>
<li><p>1-4 → heart disease present (True / 1)</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="exercise-10-create-a-binary-target-variable">
<h3>Exercise 10: Create a Binary Target Variable<a class="headerlink" href="#exercise-10-create-a-binary-target-variable" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>Check the type of <code class="docutils literal notranslate"><span class="pre">num</span></code> and its unique values, as you did in earlier exercises, to confirm that the data matches the description.</em></p></li>
<li><p><em>Create a new column at the end of the DataFrame called <code class="docutils literal notranslate"><span class="pre">heart_disease_binary</span></code>. This column should contain 0 if <code class="docutils literal notranslate"><span class="pre">num</span></code> is 0, and 1 otherwise. Use a lambda function to perform this transformation.</em></p></li>
<li><p><em>Print the final DataFrame to verify the result.</em></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id9">
<h4>Solution:<a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1.1 Check the type of the &#39;num&#39; column using the variable information</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--- Checking target variable &quot;num&quot; ---&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Data type of &quot;num&quot;: </span><span class="si">{</span><span class="n">variables</span><span class="p">[</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;num&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># 1.2 Get the unique values and number of unique values in &#39;num&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unique values in &quot;num&quot;: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of unique values in &quot;num&quot;: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># 2. Add a new column &#39;heart_disease_binary&#39;:</span>
<span class="c1"># 0 if &#39;num&#39; is 0 (no heart disease), 1 otherwise (any heart disease)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;heart_disease_binary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 3. Print the first 5 rows of the updated DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">First 5 rows of the final DataFrame:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Checking target variable &quot;num&quot; ---
Data type of &quot;num&quot;: Integer
Unique values in &quot;num&quot;: [0 2 1 3 4]
Number of unique values in &quot;num&quot;: 5

First 5 rows of the final DataFrame:
   age  sex  cp  trestbps  chol  fbs  restecg  thalach  exang  oldpeak  slope  \
0   63    1   1       145   233    1        2      150      0      2.3      3   
1   67    1   4       160   286    0        2      108      1      1.5      2   
2   67    1   4       120   229    0        2      129      1      2.6      2   
3   37    1   3       130   250    0        0      187      0      3.5      3   
4   41    0   2       130   204    0        2      172      0      1.4      1   

    ca  thal  num  heart_disease_binary  
0  0.0   6.0    0                     0  
1  3.0   3.0    2                     1  
2  2.0   7.0    1                     1  
3  0.0   3.0    0                     0  
4  0.0   3.0    0                     0  
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
</section>
<hr class="docutils" />
<section id="exploratory-data-analysis-eda">
<h2>Exploratory Data Analysis (EDA)<a class="headerlink" href="#exploratory-data-analysis-eda" title="Link to this heading">#</a></h2>
<p>Now that the dataset is clean, we can begin exploring the different features. Visualisation is a key part of <strong>exploratory data analysis (EDA)</strong>: it helps us detect patterns, identify outliers, and better understand the structure of our data — all of which can inform future modelling decisions.</p>
<p>We’ll start by plotting the <strong>individual features</strong> to understand their distributions. Depending on the type of feature, different plots and analysis methods are needed. There are two main types:</p>
<ul class="simple">
<li><p>Numerical (quantities and measurements)</p></li>
<li><p>Categorical (groups, types, labels)</p></li>
</ul>
<p>Note that this type may not always align perfectly with the type Python assigns to a value. We will refer to whether the feature is numerical or categorical as its <strong>feature type</strong>, and the type you get from Python when using <code class="docutils literal notranslate"><span class="pre">type()</span></code> as its <strong>Python type</strong>.</p>
<p><strong>Numerical Features</strong></p>
<p>These represent measurable quantities, and they can be either:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Example from Dataset</p></th>
<th class="head"><p>Visualisation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Continuous</p></td>
<td><p>Can take any value within a range</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">chol</span></code> (serum cholesterol), <code class="docutils literal notranslate"><span class="pre">oldpeak</span></code> (ST depression)</p></td>
<td><p>Histogram</p></td>
</tr>
<tr class="row-odd"><td><p>Discrete</p></td>
<td><p>Countable whole numbers</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ca</span></code> (number of major vessels)</p></td>
<td><p>Histogram or bar plot</p></td>
</tr>
</tbody>
</table>
</div>
<p>Even though both feature types are numeric, you might treat them differently in analysis. For example, <strong>standardisation</strong> usually makes sense for continuous variables but not for small-range discrete variables like <code class="docutils literal notranslate"><span class="pre">ca</span></code> or <code class="docutils literal notranslate"><span class="pre">slope</span></code> (slope of the peak exercise ST segment).</p>
<div class="note admonition">
<p class="admonition-title">Continuous vs Discrete – Real vs Representation</p>
<p>Some variables, like <strong>age</strong>, may appear <strong>discrete</strong> in a dataset (e.g. whole years),<br />
but they are <strong>inherently continuous</strong> — people can be 18.5 or 73.2 years old.<br />
Because it spans a wide range and behaves like a measurement, <strong>age is typically analysed as continuous</strong>.</p>
<p>In contrast, features like <strong>number of vessels (<code class="docutils literal notranslate"><span class="pre">ca</span></code>)</strong> are <strong>truly discrete</strong>:<br />
you can’t have 2.5 vessels — it’s either 2 or 3. These are counts and must be treated accordingly.</p>
<ul class="simple">
<li><p>Discrete features with <strong>many unique values</strong> (like age) are often analysed as continuous.</p></li>
<li><p>Truly discrete, <strong>count-based</strong> features are handled differently — especially in statistical models.</p></li>
</ul>
</div>
<p><strong>Categorical Features</strong></p>
<p>These represent groups or labels. They can be:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Example from Dataset</p></th>
<th class="head"><p>Visualisation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Nominal</p></td>
<td><p>No natural order</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sex</span></code> (biological sex), <code class="docutils literal notranslate"><span class="pre">cp</span></code> (chest pain type), <code class="docutils literal notranslate"><span class="pre">thal</span></code> (thalassemia: 3 = normal, 6 = fixed defect, 7 = reversible defect)</p></td>
<td><p>Bar plot</p></td>
</tr>
<tr class="row-odd"><td><p>Ordinal</p></td>
<td><p>Ordered categories</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">slope</span></code> (slope of ST segment: up, flat, down)</p></td>
<td><p>Bar plot</p></td>
</tr>
</tbody>
</table>
</div>
<p>Just because a feature is stored as an integer doesn’t mean its <strong>feature type</strong> is numerical. Many <strong>categorical variables</strong> are encoded as integers (e.g., <code class="docutils literal notranslate"><span class="pre">sex</span></code>, <code class="docutils literal notranslate"><span class="pre">cp</span></code>, <code class="docutils literal notranslate"><span class="pre">slope</span></code>, <code class="docutils literal notranslate"><span class="pre">thal</span></code>), but these values represent <strong>categories</strong>, not measurements.</p>
<div class="note admonition">
<p class="admonition-title">Identifiers</p>
<p>Some biomedical datasets include identifiers (e.g., patient ID or record number). These are usually:</p>
<ul class="simple">
<li><p>Unique to each row</p></li>
<li><p>Not useful for prediction</p></li>
<li><p>Should not be plotted or included in modelling</p></li>
</ul>
</div>
<p>Always check the variable and its description to determine whether it is categorical or numerical. You can use several types of information to help guide your decision:</p>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">.dtypes</span></code> on the DataFrame:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">float64</span></code> → likely continuous</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int64</span></code> → could be either discrete or categorical</p></li>
</ul>
</li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">.nunique()</span></code> on the DataFrame:</p>
<ul>
<li><p>Few unique values (e.g., 2–4) → probably categorical</p></li>
<li><p>Many unique values (30+) → likely continuous</p></li>
</ul>
</li>
<li><p>Use the variable descriptions or metadata:</p>
<ul>
<li><p>They say if the the “Categorical” or “Integer”</p></li>
<li><p>Does it describe a <strong>measurement</strong> (e.g., blood pressure)? → Numerical</p></li>
<li><p>Does it describe a <strong>group or type</strong> (e.g., chest pain type)? → Categorical</p></li>
</ul>
</li>
</ul>
<p>If you are unsure, you can always try plotting both a histogram and a bar plot, and see which one better reflects the nature of the data.</p>
<hr class="docutils" />
<section id="exercise-11-classify-each-variable-by-type">
<h3>Exercise 11: Classify Each Variable by Type<a class="headerlink" href="#exercise-11-classify-each-variable-by-type" title="Link to this heading">#</a></h3>
<p><em>Identify the type of each feature. This will help guide your choice of visualisation, transformation, or statistical method later. Consider the following variable types:</em></p>
<ul class="simple">
<li><p><strong>Continuous numerical</strong> – real-valued measurements with many unique values</p></li>
<li><p><strong>Discrete numerical</strong> – count-based integers</p></li>
<li><p><strong>Nominal categorical</strong> – unordered categories</p>
<ul>
<li><p><em>Binary</em> – a special case with exactly two values</p></li>
</ul>
</li>
<li><p><strong>Ordinal categorical</strong> – ordered categories</p></li>
<li><p><strong>Identifier / metadata</strong> – e.g., patient IDs (not used in modelling)</p></li>
</ul>
<p><em>(Not all types may be present in this dataset)</em></p>
<p><em>Create a list of categorical and numerical features and assign the feature names accordingly (you can ignore subtypes such as binary or ordinal for now).</em></p>
<div class="note admonition">
<p class="admonition-title">Target variables in EDA</p>
<p>Although <code class="docutils literal notranslate"><span class="pre">heart_disease_binary</span></code> is a target variable, you can include it (and the non-binary version <code class="docutils literal notranslate"><span class="pre">num</span></code>) in the classification for exploratory analysis — just keep in mind that it won’t be used as a feature during modelling.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id10">
<h4>Solution:<a class="headerlink" href="#id10" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the data types of each column</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data types:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>

<span class="c1"># Check the number of unique values per column</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Number of unique values:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>

<span class="c1"># Display feature descriptions from the variable metadata</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Feature descriptions:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">variables</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data types:
 age                       int64
sex                       int64
cp                        int64
trestbps                  int64
chol                      int64
fbs                       int64
restecg                   int64
thalach                   int64
exang                     int64
oldpeak                 float64
slope                     int64
ca                      float64
thal                    float64
num                       int64
heart_disease_binary      int64
dtype: object

Number of unique values:
 age                      41
sex                       2
cp                        4
trestbps                 50
chol                    152
fbs                       2
restecg                   3
thalach                  91
exang                     2
oldpeak                  40
slope                     3
ca                        4
thal                      3
num                       5
heart_disease_binary      2
dtype: int64

Feature descriptions:
         name         type                                        description
0        age      Integer                                               None
1        sex  Categorical                                               None
2         cp  Categorical                                               None
3   trestbps      Integer  resting blood pressure (on admission to the ho...
4       chol      Integer                                  serum cholestoral
5        fbs  Categorical                    fasting blood sugar &gt; 120 mg/dl
6    restecg  Categorical                                               None
7    thalach      Integer                        maximum heart rate achieved
8      exang  Categorical                            exercise induced angina
9    oldpeak      Integer  ST depression induced by exercise relative to ...
10     slope  Categorical                                               None
11        ca      Integer  number of major vessels (0-3) colored by flour...
12      thal  Categorical                                               None
13       num      Integer                         diagnosis of heart disease
</pre></div>
</div>
</div>
</div>
<p><strong>Continuous Numerical</strong></p>
<p>These are real-valued measurements with many unique values.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Unique Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">age</span></code></p></td>
<td><p>Age in years</p></td>
<td><p>41</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">trestbps</span></code></p></td>
<td><p>Resting blood pressure (on admission to hospital)</p></td>
<td><p>50</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">chol</span></code></p></td>
<td><p>Serum cholesterol</p></td>
<td><p>152</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">thalach</span></code></p></td>
<td><p>Maximum heart rate achieved</p></td>
<td><p>91</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">oldpeak</span></code></p></td>
<td><p>ST depression induced by exercise</p></td>
<td><p>40</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Discrete Numerical</strong></p>
<p>Count-based integer values with a small range.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Unique Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ca</span></code></p></td>
<td><p>Number of major vessels (0–3) coloured by fluoroscopy</p></td>
<td><p>4</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Nominal Categorical</strong></p>
<p>Unordered categories, sometimes binary.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Unique Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sex</span></code></p></td>
<td><p>0 = Female, 1 = Male</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cp</span></code></p></td>
<td><p>Chest pain type</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fbs</span></code></p></td>
<td><p>Fasting blood sugar &gt; 120 mg/dl</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">restecg</span></code></p></td>
<td><p>Resting ECG results</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">exang</span></code></p></td>
<td><p>Exercise-induced angina</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">thal</span></code></p></td>
<td><p>Thalassemia test result</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">heart_disease_binary</span></code></p></td>
<td><p>Binary recoding of target variable</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Ordinal Categorical</strong></p>
<p>Discrete categories with meaningful order.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Unique Values</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">slope</span></code></p></td>
<td><p>Slope of the ST segment during peak exercise</p></td>
<td><p>3</p></td>
<td><p>Ordinal (up/flat/down)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">num</span></code></p></td>
<td><p>Heart disease diagnosis (0 = none, 1–4 = increasing severity)</p></td>
<td><p>5</p></td>
<td><p>Ordinal target variable</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Identifier / Metadata</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>(none)</em></p></td>
<td><p>No ID column used</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numerical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;trestbps&#39;</span><span class="p">,</span> <span class="s1">&#39;chol&#39;</span><span class="p">,</span> <span class="s1">&#39;thalach&#39;</span><span class="p">,</span> <span class="s1">&#39;oldpeak&#39;</span><span class="p">,</span> <span class="s1">&#39;ca&#39;</span><span class="p">]</span>
<span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="s1">&#39;cp&#39;</span><span class="p">,</span> <span class="s1">&#39;fbs&#39;</span><span class="p">,</span> <span class="s1">&#39;restecg&#39;</span><span class="p">,</span> <span class="s1">&#39;exang&#39;</span><span class="p">,</span> <span class="s1">&#39;slope&#39;</span><span class="p">,</span> <span class="s1">&#39;thal&#39;</span><span class="p">,</span> <span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="s1">&#39;heart_disease_binary&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>Now that you’ve classified the type of each feature, you can start visualising them.</p>
<p>We’ll begin with <strong>categorical variables</strong>, which are best visualised using <strong>bar plots</strong>. A bar plot shows how many times each category appears in the dataset. This helps you:</p>
<ul class="simple">
<li><p>Understand <strong>class balance</strong> (e.g., how many patients are male vs female)</p></li>
<li><p>Identify <strong>rare or dominant categories</strong></p></li>
<li><p>Spot <strong>potential modelling issues</strong> like highly imbalanced features</p></li>
</ul>
<p>Bar plots are especially useful when working with binary or low-cardinality features, and they provide quick insights into how the data is distributed.</p>
<p>Bar plots are particularly helpful for <strong>binary</strong> and <strong>low-cardinality</strong> features — that is, those with just a few unique values. They give you a quick overview of how the categories are distributed, which can inform later modelling choices.</p>
</section>
</section>
<hr class="docutils" />
<section id="exercise-12-visualise-categorical-feature-distributions">
<h3>Exercise 12: Visualise Categorical Feature Distributions<a class="headerlink" href="#exercise-12-visualise-categorical-feature-distributions" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>Import the <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> library as <code class="docutils literal notranslate"><span class="pre">plt</span></code> and <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>.</em></p></li>
<li><p><em>Create a function to generate a bar plot for a categorical feature - include labels, a legend, and a title. You can use either <code class="docutils literal notranslate"><span class="pre">.countplot()</span></code> from <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>, or extract the value counts from the dataframe and use <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> on them.</em></p></li>
<li><p><em>Loop through the categorial feature list to create bar plots for each of them.</em></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id11">
<h4>Solution:<a class="headerlink" href="#id11" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Import the necessary libraries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># 2. Define a function to generate bar plots for categorical features</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_categorical_distribution</span><span class="p">(</span><span class="n">feature</span><span class="p">):</span>
    <span class="c1"># 2.1 Use Seaborn to create a count plot for the selected feature</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">feature</span><span class="p">)</span>
    
    <span class="c1"># Alternative option: get value counts and plot manually using pandas</span>
    <span class="c1"># value_counts = df[feature].value_counts().sort_index()</span>
    <span class="c1"># value_counts.plot(kind=&#39;bar&#39;, edgecolor=&#39;black&#39;)</span>

    <span class="c1"># 2.2 Add title and axis labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>

    <span class="c1"># 2.3 Display the plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 3. Loop through the categorical features and create bar plots for each</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">categorical_features</span><span class="p">:</span>
    <span class="n">plot_categorical_distribution</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/29b3dff4f1a417fa0c3aa69af66e1c42627bd1f486a1d0e52b43006f8c2dacd8.png" src="../_images/29b3dff4f1a417fa0c3aa69af66e1c42627bd1f486a1d0e52b43006f8c2dacd8.png" />
<img alt="../_images/6d0a9b73fd7e2596222ce27626161d0b48cc24c1e17e39a91856d4ec8b1a96fe.png" src="../_images/6d0a9b73fd7e2596222ce27626161d0b48cc24c1e17e39a91856d4ec8b1a96fe.png" />
<img alt="../_images/28c6aeab0dc421916cdf836d18f78ef45db1e1cdd3fceee035ae044275eb46fa.png" src="../_images/28c6aeab0dc421916cdf836d18f78ef45db1e1cdd3fceee035ae044275eb46fa.png" />
<img alt="../_images/c6dba1b808244ed540cc59291cdda317030c888737820884e11fff1b40cc35a2.png" src="../_images/c6dba1b808244ed540cc59291cdda317030c888737820884e11fff1b40cc35a2.png" />
<img alt="../_images/3935c4015d458ab84ef04ed3c78d6ef8a6bf39816c84a66dc270eef0c91fed3a.png" src="../_images/3935c4015d458ab84ef04ed3c78d6ef8a6bf39816c84a66dc270eef0c91fed3a.png" />
<img alt="../_images/d17b49d94d459578c72d12da79dae8f3cb7ab6e10e93ae72b394c791a5a1a6c7.png" src="../_images/d17b49d94d459578c72d12da79dae8f3cb7ab6e10e93ae72b394c791a5a1a6c7.png" />
<img alt="../_images/9f8c3c73102a0558f4477064ff572134c468a658b876cddc28098f0a4fd56b0e.png" src="../_images/9f8c3c73102a0558f4477064ff572134c468a658b876cddc28098f0a4fd56b0e.png" />
<img alt="../_images/d1d21025a3e31e58acca9c70782fc4f87fe23510ce23cb6cd0d1bc774ecca706.png" src="../_images/d1d21025a3e31e58acca9c70782fc4f87fe23510ce23cb6cd0d1bc774ecca706.png" />
<img alt="../_images/2443ab636a18c6d01036d3dbbe054ef15e9fdb0da829e29a51148ca9ef166c39.png" src="../_images/2443ab636a18c6d01036d3dbbe054ef15e9fdb0da829e29a51148ca9ef166c39.png" />
</div>
</div>
<hr class="docutils" />
<p>Let’s now do the same for the <strong>continuous numerical features</strong> you identified earlier.</p>
<p>We will use <strong>histograms</strong> as they are ideal for:</p>
<ul class="simple">
<li><p>Understanding the <strong>shape</strong> of the distribution (e.g., symmetric, skewed, bimodal)</p></li>
<li><p>Identifying <strong>outliers</strong> or unusual values</p></li>
<li><p>Comparing <strong>ranges and spread</strong> between features</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="exercise-13-visualising-numerical-features-distributions">
<h3>Exercise 13: Visualising Numerical Features Distributions<a class="headerlink" href="#exercise-13-visualising-numerical-features-distributions" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>Create a function to generate a histogram for a numerical feature — include labels, a legend (if appropriate), and a title. You can use either <code class="docutils literal notranslate"><span class="pre">.histplot()</span></code> from <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> or <code class="docutils literal notranslate"><span class="pre">.hist()</span></code> from <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</em></p></li>
<li><p><em>Loop through the list of numerical features to create a histogram for each of them.</em></p></li>
</ol>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Tip</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Use <code class="docutils literal notranslate"><span class="pre">bins=20</span></code> and <code class="docutils literal notranslate"><span class="pre">edgecolor='black'</span></code> with either <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> or <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> to make your histograms easier to read and visually appealing.</p>
</div>
</details><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id12">
<h4>Solution:<a class="headerlink" href="#id12" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Create a function to create a histogram for numerical features</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_numerical_distribution</span><span class="p">(</span><span class="n">feature</span><span class="p">):</span>
    <span class="c1"># 1.1 Use seaborn to create the histogram</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    
    <span class="c1"># 1.1 Other option: use matplotlib to create the histogram</span>
    <span class="c1"># plt.hist(df[feature], bins=20, edgecolor=&#39;black&#39;)</span>

    <span class="c1"># 1.2 Add title and labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>

    <span class="c1"># 1.3 Show the plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 2. Loop through the numerical features and create histograms</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numerical_features</span><span class="p">):</span>
    <span class="n">plot_numerical_distribution</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c39cf179fab48d98276c72750fdf20a002cf96c6b977f075637feefa1635bfd3.png" src="../_images/c39cf179fab48d98276c72750fdf20a002cf96c6b977f075637feefa1635bfd3.png" />
<img alt="../_images/8253faabebfa32ae92bc17d36d453f968ceb34029d771574c9b7678bfa1dd3ad.png" src="../_images/8253faabebfa32ae92bc17d36d453f968ceb34029d771574c9b7678bfa1dd3ad.png" />
<img alt="../_images/6bf01e4c3fe0fef943fe57ca0d40fef36e5ccc47ed49badc395ab9d4ff77333b.png" src="../_images/6bf01e4c3fe0fef943fe57ca0d40fef36e5ccc47ed49badc395ab9d4ff77333b.png" />
<img alt="../_images/917ed05b179eb6f09a6b431717b5f19731b7ba0bdff52b8bfe0aa641f2921516.png" src="../_images/917ed05b179eb6f09a6b431717b5f19731b7ba0bdff52b8bfe0aa641f2921516.png" />
<img alt="../_images/7e4d99f356ee1e63268f76c26a80fbe5e38157e68887ce50299fe925750da9c6.png" src="../_images/7e4d99f356ee1e63268f76c26a80fbe5e38157e68887ce50299fe925750da9c6.png" />
<img alt="../_images/f723baef3bc78a5945ec272f9c51d6d91d954d4249c868d1cd7fbffba103ee74.png" src="../_images/f723baef3bc78a5945ec272f9c51d6d91d954d4249c868d1cd7fbffba103ee74.png" />
</div>
</div>
<p><strong>What Do These Distributions Tell Us?</strong></p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">age</span></code></strong>: Fairly symmetric and bell-shaped — roughly normal distribution, centred around 55–60.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">trestbps</span></code></strong> <em>(resting blood pressure)</em>: Slightly right-skewed, with a cluster between 115–140.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">chol</span></code></strong> <em>(cholesterol)</em>: Right-skewed, with a long tail — a patient has an unusually high value (potential outlier).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">thalach</span></code></strong> <em>(maximum heart rate)</em>: Slightly left-skewed, with most values between 140–170.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">oldpeak</span></code></strong> <em>(ST depression)</em>: Strongly right-skewed — many patients have values near 0, with a long tail toward higher values.
-<strong><code class="docutils literal notranslate"><span class="pre">ca</span></code></strong>: Looks a bit weird since it is discrete numerical - could be plotted with a boxplot instead. Left-skewed, with most patients having 0 vessels.</p></li>
</ul>
<p>These observations are useful:</p>
<ul class="simple">
<li><p>Features like <strong><code class="docutils literal notranslate"><span class="pre">oldpeak</span></code></strong> or <strong><code class="docutils literal notranslate"><span class="pre">chol</span></code></strong> might benefit from a <strong>log transformation</strong> before statistical analysis.</p></li>
<li><p>Distributions that are already symmetric (like <code class="docutils literal notranslate"><span class="pre">age</span></code>) are often easier to model or compare.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="exercise-14-detecting-potential-outliers-with-boxplots">
<h3>Exercise 14: Detecting Potential Outliers with Boxplots<a class="headerlink" href="#exercise-14-detecting-potential-outliers-with-boxplots" title="Link to this heading">#</a></h3>
<p>Histograms are great for understanding overall shape, but they can sometimes hide extreme values (outliers). A boxplot shows the median, spread, and any unusually high or low points — which can help detect issues early.</p>
<p>In clinical data, outliers are often real and meaningful, such as a patient with very high cholesterol. However, it’s still worth checking them!</p>
<p><strong>Task:</strong></p>
<ol class="arabic simple">
<li><p><em>Create a boxplot for each numerical feature (not stratified by group).</em></p></li>
<li><p><em>Use <code class="docutils literal notranslate"><span class="pre">sns.boxplot()</span></code> in a loop, one subplot per feature.</em></p></li>
<li><p><em>Add titles and axis labels.</em></p></li>
<li><p><em>Look for skewed distributions or values that might need special attention later.</em></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id13">
<h4>Solution:<a class="headerlink" href="#id13" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Set up the figure size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># 2. Loop through each numerical feature and create a boxplot</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numerical_features</span><span class="p">):</span>
    <span class="c1"># 2.1. Create subplot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># 2.2. Draw boxplot</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="c1"># 2.3. Add title</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Boxplot of </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># 2.4. Label x-axis</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

<span class="c1"># 3. Adjust layout for clarity</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a310dc9481893a81a3b6730173dfa74c5a8ad495fd07ed3871f22abf6d17e645.png" src="../_images/a310dc9481893a81a3b6730173dfa74c5a8ad495fd07ed3871f22abf6d17e645.png" />
</div>
</div>
<p><strong>What do we see?</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">chol</span></code> (cholesterol) <code class="docutils literal notranslate"><span class="pre">trestbps</span></code> (resting blood pressure) and <code class="docutils literal notranslate"><span class="pre">oldpeak</span></code> (ST depression) show <strong>clear outliers</strong> — some patients have unusually high values, which are <strong>likely valid clinical extremes</strong> rather than errors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">thalach</span></code> (maximum heart rate) has a lower outlier, but overall looks more symmetric.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ca</span></code> is a discrete variable with some spread, but some patients have an unusually high value (3), which may or may not need further inspection.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">age</span></code> looks <strong>reasonably symmetric</strong> without obvious outliers.</p></li>
</ul>
<p>These patterns help decide <strong>which variables may need transformation</strong>, <strong>robust methods</strong>, or <strong>extra attention during modelling or cleaning</strong>.</p>
<hr class="docutils" />
<p>For now, you’ve only explored the distribution of features across the <strong>entire dataset</strong>. However, it’s often useful to examine <strong>subgroups</strong> to understand how they differ. For example, male and female patients may exhibit different patterns in how diseases present. Let’s investigate whether any feature distributions vary between male and female patients. This can help identify biological or physiological differences, highlight features that may benefit from sex-specific modelling, and determine whether standardisation should be stratified (i.e., performed within each subgroup rather than across the full dataset).</p>
<div class="warning admonition">
<p class="admonition-title">Unequal group sizes can affect your interpretations</p>
<p>In our dataset, around <strong>68% of patients are male</strong> and only <strong>32% are female</strong>.</p>
<p>This imbalance can affect how we interpret feature distributions. For example, if a certain chest pain type appears more frequently in males, it might simply reflect the larger number of male patients — not a true difference in risk or symptoms.</p>
</div>
</section>
</section>
<hr class="docutils" />
<section id="exercise-15-compare-categorical-distributions-by-sex">
<h3>Exercise 15: Compare Categorical Distributions by Sex<a class="headerlink" href="#exercise-15-compare-categorical-distributions-by-sex" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>Create a plot with as many subplots as there are categorical features.</em></p></li>
<li><p><em>Loop through each of the categorical features.</em></p></li>
<li><p><em>Within the loop: Create a bar plot for each feature, stratified by sex. You should show one bar per category <strong>within each sex group</strong>  - include axis labels, a legend, and a title. You can use either <code class="docutils literal notranslate"><span class="pre">.countplot()</span></code> from seaborn, or compute the counts manually and use <code class="docutils literal notranslate"><span class="pre">.plot()</span></code>.</em></p></li>
</ol>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Tip</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text">Use <code class="docutils literal notranslate"><span class="pre">enumerate(categorical_list)</span></code> when looping through the list to access both the index and the feature name. The index is useful for selecting the correct subplot, while the name is needed for labelling.</p></li>
<li><p class="sd-card-text">Set <code class="docutils literal notranslate"><span class="pre">hue='sex'</span></code> in <code class="docutils literal notranslate"><span class="pre">.countplot()</span></code> to stratify the bars by sex.</p></li>
<li><p class="sd-card-text">Alternatively, use <code class="docutils literal notranslate"><span class="pre">pd.crosstab()</span></code> or <code class="docutils literal notranslate"><span class="pre">df.groupby('sex')[feature].value_counts()</span></code> to compute subgroup counts if you prefer to use <code class="docutils literal notranslate"><span class="pre">.plot()</span></code>.</p></li>
</ul>
</div>
</details><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id14">
<h4>Solution:<a class="headerlink" href="#id14" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="c1"># 1.1 Get length of categorical features</span>
<span class="c1"># Note: The first entry in the categorical feature list is &#39;sex&#39;, which is used for stratification.</span>
<span class="c1"># So let’s create a new list without it.</span>
<span class="n">categorical_features_for_stratification</span> <span class="o">=</span> <span class="n">categorical_features</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">categorical_features</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">categorical_features_for_stratification</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of categorical features (excluding sex): </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">categorical_features_for_stratification</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># 1.2 Dynamically set up subplot grid</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categorical_features_for_stratification</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">rows</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">cols</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">cols</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">rows</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>  <span class="c1"># Flatten for easier indexing</span>

<span class="c1"># 2. Loop through the categorical features and create count plots</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">categorical_features_for_stratification</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> by sex&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Female&quot;</span><span class="p">,</span> <span class="s2">&quot;Male&quot;</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>

<span class="c1"># 3. Remove any unused subplots</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;sex&#39;, &#39;cp&#39;, &#39;fbs&#39;, &#39;restecg&#39;, &#39;exang&#39;, &#39;slope&#39;, &#39;thal&#39;, &#39;num&#39;, &#39;heart_disease_binary&#39;]
[&#39;cp&#39;, &#39;fbs&#39;, &#39;restecg&#39;, &#39;exang&#39;, &#39;slope&#39;, &#39;thal&#39;, &#39;num&#39;, &#39;heart_disease_binary&#39;]
Number of categorical features (excluding sex): 8
</pre></div>
</div>
<img alt="../_images/fc30dffb67a8437f748f36a81b20024e22fd175f056182c2d8652353f54e0de5.png" src="../_images/fc30dffb67a8437f748f36a81b20024e22fd175f056182c2d8652353f54e0de5.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="exercise-16-compare-numerical-features-by-sex">
<h3>Exercise 16: Compare Numerical Features by Sex<a class="headerlink" href="#exercise-16-compare-numerical-features-by-sex" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>Create a plot with as many subplots as there are numerical features.</em></p></li>
<li><p><em>Loop through each of the numerical features.</em></p></li>
<li><p><em>Within the loop: Plot a subplot of overlaid histograms for male and female patients for that feature. Include axis labels, a legend, and a title. You can use either <code class="docutils literal notranslate"><span class="pre">.histplot()</span></code> from <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> or <code class="docutils literal notranslate"><span class="pre">.hist()</span></code> from <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</em></p></li>
</ol>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Tip</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text">Set <code class="docutils literal notranslate"><span class="pre">hue='sex'</span></code> in <code class="docutils literal notranslate"><span class="pre">.histplot()</span></code> to have it <strong>stratified</strong> by sex.</p></li>
<li><p class="sd-card-text">If using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, create two histograms in the same subplot (one for each sex) by selecting the appropriate subset from the main dataframe.</p></li>
</ul>
</div>
</details><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id15">
<h4>Solution:<a class="headerlink" href="#id15" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1.1 Get number of numerical features</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of numerical features: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">numerical_features</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># 1.2 Set up subplot grid</span>
<span class="c1"># We have 6 numerical features – let&#39;s create a 3 x 2 grid to plot them</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="c1"># 2. Loop through the numerical features and create histograms</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numerical_features</span><span class="p">):</span>
    <span class="c1"># 2.1 Create a histogram for each feature stratified by sex using seaborn</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">])</span>  

    <span class="c1"># 2.1 Alternative option: use matplotlib to create histograms for each sex</span>
    <span class="c1"># axes[i // 2, i % 2].hist(df[df[&#39;sex&#39;] == 0][feature], bins=20, alpha=0.5, label=&#39;Female&#39;, edgecolor=&#39;black&#39;)</span>
    <span class="c1"># axes[i // 2, i % 2].hist(df[df[&#39;sex&#39;] == 1][feature], bins=20, alpha=0.5, label=&#39;Male&#39;, edgecolor=&#39;black&#39;)</span>

    <span class="c1"># 2.2 Add title and labels</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> by sex&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Female&quot;</span><span class="p">,</span> <span class="s2">&quot;Male&quot;</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>

<span class="c1"># Adjust layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of numerical features: 6
</pre></div>
</div>
<img alt="../_images/85fc63ccda13d610ec05ffc8d2df5715a12adcc248bc7597fa5e12f0cf97a0bf.png" src="../_images/85fc63ccda13d610ec05ffc8d2df5715a12adcc248bc7597fa5e12f0cf97a0bf.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="exercise-17-boxplots-of-numerical-features-by-sex">
<h3>Exercise 17: Boxplots of Numerical Features by Sex<a class="headerlink" href="#exercise-17-boxplots-of-numerical-features-by-sex" title="Link to this heading">#</a></h3>
<p><em>In the previous exercise, you used <strong>stratified histograms</strong> to explore how the distribution of each numerical variable differs between males and females. Now, you’ll use <strong>boxplots</strong> to visualise these differences. While histograms are better for understanding the full shape of a distribution (e.g., unimodal, skewed, bimodal), boxplots provide a cleaner summary of central tendency and variability — especially for comparing groups.</em></p>
<p><strong>Task:</strong></p>
<ol class="arabic simple">
<li><p><em>Create a plot with as many subplots as there are numerical features.</em></p></li>
<li><p><em>Loop through each of the numerical features.</em></p></li>
<li><p><em>Within the loop: Plot a subplot of a boxplot comparing the distribution for male and female patients for that feature — include labels, a legend, and a title. Use <code class="docutils literal notranslate"><span class="pre">.boxplot()</span></code> from <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>, similar to how you used <code class="docutils literal notranslate"><span class="pre">.histplot()</span></code> previously.</em></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id16">
<h4>Solution:<a class="headerlink" href="#id16" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Set up the subplot grid</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>

<span class="c1"># 2. Loop through the numerical features and create boxplots</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numerical_features</span><span class="p">):</span>
    <span class="c1"># 3.1 Create a boxplot for each feature stratified by sex using seaborn</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">])</span>
    
    <span class="c1"># 3.2 Add title and labels</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> by sex&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Female&quot;</span><span class="p">,</span> <span class="s2">&quot;Male&quot;</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
   
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/be4ff65a6f8d51a4c92357003ebe24b1bc030c75da170ef94ca18d441fa4a18d.png" src="../_images/be4ff65a6f8d51a4c92357003ebe24b1bc030c75da170ef94ca18d441fa4a18d.png" />
</div>
</div>
<hr class="docutils" />
<p>The next step after looking at the distributions of the features for the whole dataset or subgroups is to start exploring the relationship between two features. A <strong>correlation matrix</strong> is a powerful way to do this for two continuous features since it can be used to:</p>
<ul class="simple">
<li><p>Identify <strong>linear relationships</strong> (positive or negative) between features</p></li>
<li><p>Detect <strong>redundant features</strong> (strong correlation between features means similar information)</p></li>
<li><p>Understand which variables may interact in modelling</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="exercise-18-exploring-relationships-between-numerical-features">
<h3>Exercise 18: Exploring Relationships Between Numerical Features<a class="headerlink" href="#exercise-18-exploring-relationships-between-numerical-features" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>Create a new pandas DataFrame containing only the numerical features.</em></p></li>
<li><p><em>Use <code class="docutils literal notranslate"><span class="pre">.corr()</span></code> on the new DataFrame to compute the Pearson correlation matrix and save it in a new variable <code class="docutils literal notranslate"><span class="pre">corr_matrix</span></code>.</em></p></li>
<li><p><em>Plot the <code class="docutils literal notranslate"><span class="pre">corr_matrix</span></code> as a heatmap using <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> - include annotation, labels, a legend, and a title.</em></p></li>
<li><p><em>Interpret the heatmap:</em></p>
<ul class="simple">
<li><p><em>Which features are positively or negatively correlated?</em></p></li>
<li><p><em>Are any relationships strong (above <span class="math notranslate nohighlight">\(\pm0.6\)</span>)?</em></p></li>
<li><p><em>Do any pairs look redundant or surprisingly independent?</em></p></li>
</ul>
</li>
</ol>
<div class="note admonition">
<p class="admonition-title">Interpreting correlations carefully</p>
<p>Some correlations are expected — especially when features measure <strong>closely related aspects</strong> of the same thing. For example, resting <strong>systolic</strong> and <strong>diastolic</strong> blood pressure would naturally be correlated.</p>
<p>This isn’t necessarily a problem, but when building models, including highly correlated features can cause issues like <strong>multicollinearity</strong>. It’s a good reminder that interpreting correlation matrices also requires a bit of <strong>domain knowledge</strong> — not just statistical tools.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Tip</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text">Set <code class="docutils literal notranslate"><span class="pre">annot=True</span></code> inside <code class="docutils literal notranslate"><span class="pre">seaborn.heatmap()</span></code> to display the correlation values on the plot.</p></li>
<li><p class="sd-card-text">Set <code class="docutils literal notranslate"><span class="pre">cmap='coolwarm'</span></code> for an intuitive red–blue colour scheme.</p></li>
</ul>
</div>
</details><section id="id17">
<h4>Solution:<a class="headerlink" href="#id17" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. New dataframe with only numerical features</span>
<span class="n">df_cont</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">numerical_features</span><span class="p">]</span>

<span class="c1"># 2. Compute correlation matrix</span>
<span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">df_cont</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># 3. Plot the heatmap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pearson Correlation Matrix of Numerical Features&quot;</span><span class="p">)</span>  <span class="c1"># &lt;- Fixed typo: &quot;Person&quot; → &quot;Pearson&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e075f383b633a9c1040d246b639c766019cc0a3a76f036cbb2461010aee4002a.png" src="../_images/e075f383b633a9c1040d246b639c766019cc0a3a76f036cbb2461010aee4002a.png" />
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">age</span></code> vs <code class="docutils literal notranslate"><span class="pre">thalach</span></code>: moderate negative correlation (<span class="math notranslate nohighlight">\(–0.39\)</span>)
→ Older patients tend to have lower maximum heart rates, which aligns with expected physiology.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">thalach</span></code> vs <code class="docutils literal notranslate"><span class="pre">oldpeak</span></code>: moderate negative correlation (<span class="math notranslate nohighlight">\(–0.35\)</span>)
→ Patients with higher maximum heart rates tend to have less ST depression — potentially indicating better cardiovascular response.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trestbps</span></code>, <code class="docutils literal notranslate"><span class="pre">chol</span></code>, <code class="docutils literal notranslate"><span class="pre">oldpeak</span></code>: mostly weak correlations with each other and other features
→ Suggests they may be independent contributors and should be analysed individually.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">age</span></code> and <code class="docutils literal notranslate"><span class="pre">ca</span></code>: moderate positive correlation (<span class="math notranslate nohighlight">\(0.36\)</span>)
→ Older patients tend to have more major vessels affected — possibly reflecting cumulative cardiovascular risk.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">oldpeak</span></code> and <code class="docutils literal notranslate"><span class="pre">ca</span></code>: moderate positive correlation (<span class="math notranslate nohighlight">\(0.29\)</span>)
→ Greater ST depression is associated with more affected vessels, indicating more severe cardiac issues.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">thalack</span></code> and <code class="docutils literal notranslate"><span class="pre">ca</span></code>: moderate negative correlation (<span class="math notranslate nohighlight">\(-0.27\)</span>)
→ Patients with more affected vessels tend to have lower maximum heart rates — potentially due to reduced cardiac function.</p></li>
<li><p>All other relationships are weak (<span class="math notranslate nohighlight">\(&lt; |\pm0.3|\)</span>), indicating low multicollinearity among these features.</p></li>
</ul>
<p>Overall, none of the features appear to be strongly correlated with each other (all values are <span class="math notranslate nohighlight">\(&lt;|\pm 0.4|\)</span>). This is important because:</p>
<ul class="simple">
<li><p>Each feature might be contributing <strong>independent information</strong> to the dataset</p></li>
<li><p>There is <strong>low multicollinearity</strong>, which is beneficial for many statistical models (e.g., linear regression)</p></li>
<li><p>You may need to combine or transform features in later steps to reveal deeper patterns</p></li>
</ul>
<p>Remember, <strong>correlation only detects linear relationships</strong> — there might still be <strong>nonlinear</strong> or <strong>interaction effects</strong> worth exploring later!</p>
<hr class="docutils" />
<p>We can’t always trust the results from the Pearson correlation. Some of our continuous features are <strong>right-skewed</strong>, contain <strong>outliers</strong>, and might have <strong>non-linear</strong> relations. This violates Pearson correlation assumption of normality and linearity, which may lead to underestimation of non-linear relationship or high sensitivity to outliers.</p>
<p>Instead, you can compute the <strong>Spearman correlation</strong>, which is based on <strong>ranks</strong> rather raw values. This makes it more <strong>robust to outliers and skewness</strong>, and better suited for detecting <strong>monotonic (non-linear)</strong> relationships.</p>
</section>
</section>
<hr class="docutils" />
<section id="exercise-19-spearman-correlation">
<h3>Exercise 19: Spearman Correlation<a class="headerlink" href="#exercise-19-spearman-correlation" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>Use <code class="docutils literal notranslate"><span class="pre">.corr(method='spearman')</span></code> to compute the Spearman correlation matrix of the numerical dataframe.</em></p></li>
<li><p><em>Plot it as a heatmap (just like before).</em></p></li>
<li><p><em>Compare it to your Pearson matrix:</em></p>
<ul class="simple">
<li><p><em>Which pairs change the most?</em></p></li>
<li><p><em>Are there any new strong relationships?</em></p></li>
<li><p><em>Do any associations disappear?</em></p></li>
</ul>
</li>
</ol>
<p><em>Seeing how these two methods differ gives you a deeper understanding of your data and can help you decide whether some features need <strong>transformation</strong> or whether <strong>nonlinear methods</strong> are more appropriate downstream.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id18">
<h4>Solution:<a class="headerlink" href="#id18" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Compute Spearman correlation</span>
<span class="n">spearman_corr</span> <span class="o">=</span> <span class="n">df_cont</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">)</span>

<span class="c1"># 2. Plot the heatmap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">spearman_corr</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Spearman Correlation Matrix of Numerical Features&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ad0bc5ee088a0049b3b04cb527dbd5eb6d1c7b9bca4256bf970a18afae76acd3.png" src="../_images/ad0bc5ee088a0049b3b04cb527dbd5eb6d1c7b9bca4256bf970a18afae76acd3.png" />
</div>
</div>
<ul class="simple">
<li><p>Spearman correlation confirms most patterns seen with Pearson but also amplifies some associations, especially those involving skewed features like <code class="docutils literal notranslate"><span class="pre">oldpeak</span></code>.</p></li>
<li><p>The relationship between <code class="docutils literal notranslate"><span class="pre">thalach</span></code> and <code class="docutils literal notranslate"><span class="pre">oldpeak</span></code> becomes somewhat stronger in the Spearman matrix and stands out more clearly as the strongest among the numerical features — likely reflecting a monotonic (but not strictly linear) trend.</p></li>
<li><p>This shows the benefit of using both correlation measures: <strong>Spearman</strong> is more <strong>robust to outliers</strong> and better at capturing <strong>nonlinear</strong> or <strong>rank-based</strong> relationships that Pearson might underestimate.</p></li>
</ul>
<hr class="docutils" />
<p>You’ve explored relationships between features. Now it’s time to ask which features differ most between patients with and without heart disease. This is a crucial part of exploratory analysis and feature selection. You’ll stratify patients based on the binary outcome: <code class="docutils literal notranslate"><span class="pre">heart_disease_binary</span></code> (0 = no disease, 1 = disease).</p>
<p>We’re not only interested in <strong>visualising</strong> how distributions differ depending on whether a patient has heart disease, but also in determining whether these differences are statistically significant using <strong>statistical tests</strong>. Statistical tests return <strong>p-values</strong>. A <strong>low p-value</strong> (e.g., &lt; 0.05) suggests that the feature is significantly associated with heart disease. If the result is not significant, it may not be useful on its own — or it might only show an effect when combined with other features.</p>
<ul class="simple">
<li><p>For <strong>numerical features</strong>, we typically use a <strong>t-test</strong>, which checks if the means of the feature differ significantly between patients with and without heart disease.</p></li>
<li><p>If the feature distribution is <strong>non-normal</strong>, we use the <strong>Mann–Whitney U test</strong>, a non-parametric alternative.</p></li>
<li><p>For <strong>categorical features</strong>, we use a <strong>chi-squared test of independence</strong>, which checks whether category counts differ significantly between the two patient groups.</p></li>
</ul>
<p>This part is a bit more advanced than what we’ve done so far — it will require you to look up and interpret functions yourself. This is an important skill to develop, since in real projects you’ll often need to explore new functions or packages for specific tasks. A great starting point is to Google the function name along with keywords like <em>“python”</em> or the package name. In this case, check out the <code class="docutils literal notranslate"><span class="pre">scipy</span></code> package documentation:
<a class="reference external" href="https://docs.scipy.org/doc/scipy/index.html">https://docs.scipy.org/doc/scipy/index.html</a>.</p>
</section>
</section>
<hr class="docutils" />
<section id="exercise-20-explore-numerical-feature-relationships-with-the-target-variable">
<h3>Exercise 20: Explore Numerical Feature Relationships with the Target Variable<a class="headerlink" href="#exercise-20-explore-numerical-feature-relationships-with-the-target-variable" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>For each numerical feature:</em></p>
<ul class="simple">
<li><p><em>Create a boxplot grouped by <code class="docutils literal notranslate"><span class="pre">heart_disease_binary</span></code>.</em></p></li>
<li><p><em>Optionally: also create stratified histograms or violin plots.</em></p></li>
</ul>
</li>
<li><p><em>Observe:</em></p>
<ul class="simple">
<li><p><em>Which variables show clear separation between the two classes?</em></p></li>
<li><p><em>Are there noticeable shifts in distribution or outliers?</em></p></li>
<li><p><em>Which features might be informative for classification?</em></p></li>
</ul>
</li>
</ol>
<p><em>This step helps you identify potential predictors of heart disease, build intuition about what differences exist between groups, and sets the stage for later statistical testing or modelling.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id19">
<h4>Solution:<a class="headerlink" href="#id19" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1.1 Set up the subplot grid</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="c1"># 1.2 Loop through the numerical features and create boxplots</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numerical_features</span><span class="p">):</span>
    <span class="c1"># 1.3 Create a boxplot for each feature stratified by heart disease using seaborn</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;heart_disease_binary&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">])</span>
    
    <span class="c1"># 1.4 Add title and labels</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> by Heart Disease Status&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Heart Disease (0 = No, 1 = Yes)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
   
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33eca7aeb3dbaed09156c9fa732b11a05d945dd1fdf251a616adc6fc0aeb1afe.png" src="../_images/33eca7aeb3dbaed09156c9fa732b11a05d945dd1fdf251a616adc6fc0aeb1afe.png" />
</div>
</div>
<p><strong>What do we see?</strong></p>
<ul class="simple">
<li><p><strong>age</strong>:
Patients with heart disease tend to be older on average. The median shifts higher, and the entire box is elevated.</p></li>
<li><p><strong>thalach</strong> (<em>maximum heart rate</em>):
Strong visible difference: patients without heart disease have higher heart rates.</p></li>
<li><p><strong>oldpeak</strong> (<em>ST depression</em>):
Patients with heart disease tend to have higher values, with more skew and outliers. Suggests potential relevance.</p></li>
<li><p><strong>chol</strong> (<em>cholesterol</em>) and <strong>trestbps</strong> (<em>resting blood pressure</em>):
These features show overlapping distributions: any effect is weaker or obscured by variability and outliers.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="exercise-21-statistical-testing-of-numerical-feature-relationships-with-the-target-variable">
<h3>Exercise 21: Statistical Testing of Numerical Feature Relationships with the Target Variable<a class="headerlink" href="#exercise-21-statistical-testing-of-numerical-feature-relationships-with-the-target-variable" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>If needed, install <code class="docutils literal notranslate"><span class="pre">SciPy</span></code>.</em></p></li>
<li><p><em>Import <code class="docutils literal notranslate"><span class="pre">ttest_ind</span></code> and <code class="docutils literal notranslate"><span class="pre">mannwhitneyu</span></code> from <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>.</em></p></li>
<li><p><em>Split the dataframe into patients <strong>with</strong> (<code class="docutils literal notranslate"><span class="pre">heart_disease_binary</span></code> = 1) and <strong>without</strong> (<code class="docutils literal notranslate"><span class="pre">heart_disease_binary</span></code> = 0) heart disease.</em></p></li>
<li><p><em>Look at the documentation for <code class="docutils literal notranslate"><span class="pre">ttest_ind</span></code> and <code class="docutils literal notranslate"><span class="pre">mannwhitneyu</span></code> online to understand:</em></p></li>
</ol>
<ul class="simple">
<li><p><em>Required input formats (e.g., two arrays of values)</em></p></li>
<li><p><em>How to extract the p‑value from each test.</em></p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p><em>For each numerical feature, perform:</em></p>
<ul class="simple">
<li><p><em>An <strong>independent two-sample t-test</strong></em></p></li>
<li><p><em>A <strong>Mann–Whitney U test</strong></em></p></li>
</ul>
</li>
<li><p><em>Print and interpret the p-values:</em></p>
<ul class="simple">
<li><p><em>Which features show statistically significant differences?</em></p></li>
<li><p><em>Do the conclusions differ between the t-test and Mann–Whitney U test?</em></p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Reminder: Check the distribution shape</p>
<p>When results <strong>disagree</strong>, it often signals a violation of assumptions — such as <strong>skewness</strong> or <strong>outliers</strong> — which makes the <strong>non-parametric test</strong> more trustworthy. Use your earlier <strong>histograms and boxplots</strong> to decide which test is more appropriate.</p>
<ul class="simple">
<li><p>If a feature is <strong>skewed</strong> or contains <strong>many outliers</strong>, the <strong>Mann–Whitney U test</strong> is generally more reliable.</p></li>
<li><p>If a feature is <strong>symmetric</strong> and approximately <strong>normally distributed</strong>, the <strong>t-test</strong> is typically suitable.</p></li>
</ul>
<p>This ensures you’re applying valid statistical assumptions and makes your results more reliable. Using <strong>both tests</strong> can also strengthen your conclusions — especially when dealing with non-normal data.</p>
</div>
<section id="id20">
<h4>Solution:<a class="headerlink" href="#id20" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Ensure scipy is installed</span>
<span class="c1"># Commented out to avoid issues when building the book.</span>
<span class="c1"># You can uncomment if running in a fresh notebook environment.</span>

<span class="c1"># try:</span>
<span class="c1">#     import scipy</span>
<span class="c1"># except ImportError:</span>
<span class="c1">#     !pip install scipy</span>

<span class="c1"># Or you can install it in your terminal:</span>
<span class="c1"># conda install -c conda-forge scipy</span>

<span class="c1"># 2. Import packages from scipy.stats for statistical tests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">ttest_ind</span><span class="p">,</span> <span class="n">mannwhitneyu</span>

<span class="c1"># 3. Split the dataset</span>
<span class="n">group_0</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;heart_disease_binary&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">group_1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;heart_disease_binary&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># 5. Do statistical tests for each numerical feature</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Statistical test results (t-test and Mann-Whitney U):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">numerical_features</span><span class="p">:</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="n">group_0</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">group_1</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span>

    <span class="c1"># Perform independent t-test</span>
    <span class="n">t_stat</span><span class="p">,</span> <span class="n">p_ttest</span> <span class="o">=</span> <span class="n">ttest_ind</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Perform Mann–Whitney U test</span>
    <span class="n">u_stat</span><span class="p">,</span> <span class="n">p_mwu</span> <span class="o">=</span> <span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  t-test p-value:  </span><span class="si">{</span><span class="n">p_ttest</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mann-Whitney U:  </span><span class="si">{</span><span class="n">p_mwu</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Statistical test results (t-test and Mann-Whitney U):

age:
  t-test p-value:  0.0001
  Mann-Whitney U:  0.0000

trestbps:
  t-test p-value:  0.0088
  Mann-Whitney U:  0.0235

chol:
  t-test p-value:  0.1650
  Mann-Whitney U:  0.0467

thalach:
  t-test p-value:  0.0000
  Mann-Whitney U:  0.0000

oldpeak:
  t-test p-value:  0.0000
  Mann-Whitney U:  0.0000

ca:
  t-test p-value:  0.0000
  Mann-Whitney U:  0.0000
</pre></div>
</div>
</div>
</div>
<p>Let’s interpret the test results using a typical significance threshold of <span class="math notranslate nohighlight">\(p &lt; 0.05\)</span>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">age</span></code>: Strong evidence of a difference between groups — both tests agree.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">thalach</span></code> and <code class="docutils literal notranslate"><span class="pre">oldpeak</span></code>: Also highly significant across both tests.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trestbps</span></code>: Marginally significant — stronger evidence from the t-test than Mann–Whitney.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chol</span></code>: The t-test does not find a significant difference, but the Mann–Whitney does.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Takeaways</p>
<ul class="simple">
<li><p>Use <strong>both tests</strong> for robustness, especially with <strong>non-normal</strong> data.</p></li>
<li><p>Several features (like <code class="docutils literal notranslate"><span class="pre">thalach</span></code> and <code class="docutils literal notranslate"><span class="pre">oldpeak</span></code>) show strong group separation — they may be useful for modelling heart disease.</p></li>
<li><p>For features like <code class="docutils literal notranslate"><span class="pre">chol</span></code>, the <strong>visualisations</strong> and <strong>test disagreement</strong> suggest caution — it may require <strong>transformation</strong> or further exploration.</p></li>
</ul>
</div>
</section>
</section>
<hr class="docutils" />
<section id="exercise-21-exploring-categorical-feature-relationships-with-the-target-variable">
<h3>Exercise 21: Exploring Categorical Feature Relationships with the Target Variable<a class="headerlink" href="#exercise-21-exploring-categorical-feature-relationships-with-the-target-variable" title="Link to this heading">#</a></h3>
<p><em>You’ve explored continuous variables in detail — now it’s time to analyse how <strong>categorical features</strong> relate to heart disease.</em></p>
<ol class="arabic simple">
<li><p><em>For each categorical feature:</em></p>
<ul class="simple">
<li><p><em>Create a bar chart grouped by <code class="docutils literal notranslate"><span class="pre">heart_disease_binary</span></code> like you did to compare female vs male patients.</em></p></li>
</ul>
</li>
<li><p><em>Observe:</em></p>
<ul class="simple">
<li><p><em>Which variables show clear differences between the two classes?</em></p></li>
<li><p><em>Which features might be informative for classification?</em></p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id21">
<h4>Solution:<a class="headerlink" href="#id21" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="c1"># Note: The last two entries in the categorical feature list include the target variable, </span>
<span class="c1"># which we are using for stratification. Let&#39;s remove them from the list of features to plot.</span>
<span class="n">categorical_features_for_stratification</span> <span class="o">=</span> <span class="n">categorical_features</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">categorical_features</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">categorical_features_for_stratification</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of categorical features (excluding target): </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">categorical_features_for_stratification</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># 1. Dynamically set up the subplot grid</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categorical_features_for_stratification</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">rows</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">cols</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">cols</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">rows</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1"># 2. Loop through the selected categorical features and create bar plots</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">categorical_features_for_stratification</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;heart_disease_binary&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> by Heart Disease&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Heart Disease&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;No Disease&quot;</span><span class="p">,</span> <span class="s2">&quot;Has Disease&quot;</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>

<span class="c1"># 3. Remove any unused subplots</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

<span class="c1"># 4. Adjust layout for better spacing</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;sex&#39;, &#39;cp&#39;, &#39;fbs&#39;, &#39;restecg&#39;, &#39;exang&#39;, &#39;slope&#39;, &#39;thal&#39;, &#39;num&#39;, &#39;heart_disease_binary&#39;]
[&#39;sex&#39;, &#39;cp&#39;, &#39;fbs&#39;, &#39;restecg&#39;, &#39;exang&#39;, &#39;slope&#39;, &#39;thal&#39;]
Number of categorical features (excluding target): 7
</pre></div>
</div>
<img alt="../_images/319afaa139a69f34c208889f46e6a8b3295a3393d9f7e64fe9a832bf4eb1c019.png" src="../_images/319afaa139a69f34c208889f46e6a8b3295a3393d9f7e64fe9a832bf4eb1c019.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="exercise-22-statistical-testing-of-categorical-feature-relationships-with-the-target-variable">
<h3>Exercise 22: Statistical Testing of Categorical Feature Relationships with the Target Variable<a class="headerlink" href="#exercise-22-statistical-testing-of-categorical-feature-relationships-with-the-target-variable" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><em>Import <code class="docutils literal notranslate"><span class="pre">chi2_contingency</span></code> from <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>.</em></p></li>
<li><p><em>Consult the documentation for <code class="docutils literal notranslate"><span class="pre">chi2_contingency</span></code> to understand:</em></p></li>
</ol>
<ul class="simple">
<li><p><em>The required input format (typically a contingency table from <code class="docutils literal notranslate"><span class="pre">pd.crosstab()</span></code> or similar)</em></p></li>
<li><p><em>How to extract the p-value from the function output</em></p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><em>For each categorical feature, construct a contingency table with heart_disease_binary and run a chi-squared test of independence.</em></p></li>
<li><p><em>Print and interpret the p-values:</em></p></li>
</ol>
<ul class="simple">
<li><p><em>Which features show statistically significant differences (<span class="math notranslate nohighlight">\(p&lt;0.05\)</span>)?</em></p></li>
<li><p><em>How might these features inform modelling or further investigation?</em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here.</span>
</pre></div>
</div>
</div>
</div>
<section id="id22">
<h4>Solution:<a class="headerlink" href="#id22" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Import the chi-squared test function</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">chi2_contingency</span>

<span class="c1"># 3. Loop through the categorical features and run chi-squared test</span>
<span class="c1"># Note: Use the cleaned list without the target variable</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Chi-squared Test Results (feature vs. heart_disease_binary):&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">categorical_features_for_stratification</span><span class="p">:</span>
    <span class="c1"># Create contingency table</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;heart_disease_binary&#39;</span><span class="p">])</span>

    <span class="c1"># Run chi-squared test</span>
    <span class="n">chi2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="c1"># Print result</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">: p-value = </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi-squared Test Results (feature vs. heart_disease_binary):
sex: p-value = 0.0000
cp: p-value = 0.0000
fbs: p-value = 1.0000
restecg: p-value = 0.0083
exang: p-value = 0.0000
slope: p-value = 0.0000
thal: p-value = 0.0000
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="congratulations-you-have-made-it-to-the-end-of-the-course">
<h2>Congratulations, you have made it to the end of the course!<a class="headerlink" href="#congratulations-you-have-made-it-to-the-end-of-the-course" title="Link to this heading">#</a></h2>
<p>We’re aware that this practice sheet hasn’t covered everything you’ve learned during the course — for example, topics like <code class="docutils literal notranslate"><span class="pre">numpy</span></code> or creating classes. We didn’t want it to get too long. But if you have some time left, try coming up with your own tasks! Think about what kinds of analyses you might want to carry out on this dataset, and how you could approach them.</p>
<p>You can always use Google to help you. Tools like ChatGPT or other large language models might also be useful if you get really stuck. But use them with care — relying on them too much can limit your learning and prevent you from developing your own problem-solving skills. Also, remember that their answers aren’t always correct.</p>
<p>We hope you enjoyed the course and found it helpful! Please let us know if there’s anything else you would have liked it to cover, if you spotted any errors, or if you have any general feedback.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "hanane-issa/python-crash-course",
            ref: "melinda_module2foundations",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "pythoncc",
            path: "./Module-8"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'pythoncc'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Module8_Questions.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">M8: Final Practice on a Heart Disease Dataset</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-the-dataset">Loading the Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-understanding-the-dataset">Exercise 1: Understanding the Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#solution">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-import-the-dataset-using-the-uci-package">Exercise 2: Import the Dataset Using the UCI Package</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-explore-the-structure-of-the-dataset-object">Exercise 3: Explore the Structure of the Dataset Object</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-summarise-the-metadata">Exercise 4: Summarise the Metadata</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5-inspect-variable-details-and-metadata">Exercise 5: Inspect Variable Details and Metadata</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6-convert-data-to-dataframe-format-for-exploration">Exercise 6: Convert Data to DataFrame Format for Exploration</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Solution:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">Data Cleaning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7-investigating-missing-values-in-the-dataset">Exercise 7: Investigating Missing Values in the Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8-removing-rows-with-missing-values">Exercise 8: Removing Rows with Missing Values</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9-checking-for-duplicate-rows-and-columns">Exercise 9: Checking for Duplicate Rows and Columns</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-create-a-binary-target-variable">Exercise 10: Create a Binary Target Variable</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Solution:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11-classify-each-variable-by-type">Exercise 11: Classify Each Variable by Type</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-12-visualise-categorical-feature-distributions">Exercise 12: Visualise Categorical Feature Distributions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-13-visualising-numerical-features-distributions">Exercise 13: Visualising Numerical Features Distributions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-14-detecting-potential-outliers-with-boxplots">Exercise 14: Detecting Potential Outliers with Boxplots</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-15-compare-categorical-distributions-by-sex">Exercise 15: Compare Categorical Distributions by Sex</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-16-compare-numerical-features-by-sex">Exercise 16: Compare Numerical Features by Sex</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-17-boxplots-of-numerical-features-by-sex">Exercise 17: Boxplots of Numerical Features by Sex</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-18-exploring-relationships-between-numerical-features">Exercise 18: Exploring Relationships Between Numerical Features</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-19-spearman-correlation">Exercise 19: Spearman Correlation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-20-explore-numerical-feature-relationships-with-the-target-variable">Exercise 20: Explore Numerical Feature Relationships with the Target Variable</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-21-statistical-testing-of-numerical-feature-relationships-with-the-target-variable">Exercise 21: Statistical Testing of Numerical Feature Relationships with the Target Variable</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-21-exploring-categorical-feature-relationships-with-the-target-variable">Exercise 21: Exploring Categorical Feature Relationships with the Target Variable</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Solution:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-22-statistical-testing-of-categorical-feature-relationships-with-the-target-variable">Exercise 22: Statistical Testing of Categorical Feature Relationships with the Target Variable</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Solution:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#congratulations-you-have-made-it-to-the-end-of-the-course">Congratulations, you have made it to the end of the course!</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>